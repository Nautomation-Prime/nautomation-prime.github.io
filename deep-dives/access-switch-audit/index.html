
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Enterprise port intelligence tool with PoE monitoring, stale port detection, and professional Excel reporting. Modular Python automation for Cisco access switches.">
      
      
        <meta name="author" content="Christopher Davies">
      
      
        <link rel="canonical" href="https://nautomation-prime.github.io/deep-dives/access-switch-audit/">
      
      
        <link rel="prev" href="../cdp-audit/">
      
      
        <link rel="next" href="../../scripts/">
      
      
        
      
      
      <link rel="icon" href="../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Access Switch Port Audit Tool - Deep Dive - Nautomation Prime</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#deep-dive-access-switch-port-audit-tool" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Nautomation Prime" class="md-header__button md-logo" aria-label="Nautomation Prime" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nautomation Prime
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Access Switch Port Audit Tool - Deep Dive
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Nautomation-Prime/Nautomation-Prime.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../getting-started/" class="md-tabs__link">
        
  
  
    
  
  Getting Started

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../services/" class="md-tabs__link">
        
  
  
    
  
  Services

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  
    
  
  Technical Resources

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../scripts/" class="md-tabs__link">
        
  
  
    
  
  Script Library

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../coming-soon/" class="md-tabs__link">
          
  
  
    
  
  Coming Soon

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../legal/privacy-policy/" class="md-tabs__link">
          
  
  
    
  
  Legal

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Nautomation Prime" class="md-nav__button md-logo" aria-label="Nautomation Prime" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Nautomation Prime
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Nautomation-Prime/Nautomation-Prime.github.io" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Getting Started
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Services
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Technical Resources
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Technical Resources
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cdp-audit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CDP Network Audit
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Access Switch Audit
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Access Switch Audit
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#enterprise-port-intelligence-distilled-to-pure-python" class="md-nav__link">
    <span class="md-ellipsis">
      
        "Enterprise Port Intelligence, Distilled to Pure Python."
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-this-tool-does" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚ú® What This Tool Does
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#the-nautomation-prime-philosophy-in-action" class="md-nav__link">
    <span class="md-ellipsis">
      
        üéØ The Nautomation Prime Philosophy in Action
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ The Nautomation Prime Philosophy in Action">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#principle-1-line-by-line-transparency" class="md-nav__link">
    <span class="md-ellipsis">
      
        Principle 1: Line-by-Line Transparency
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principle-2-hardened-for-production" class="md-nav__link">
    <span class="md-ellipsis">
      
        Principle 2: Hardened for Production
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#principle-3-vendor-neutral" class="md-nav__link">
    <span class="md-ellipsis">
      
        Principle 3: Vendor-Neutral
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-layout" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß± Project Layout
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    <span class="md-ellipsis">
      
        üì¶ Requirements
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üì¶ Requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optional-but-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        Optional but Recommended
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuration-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚öôÔ∏è Configuration System
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="‚öôÔ∏è Configuration System">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#yaml-configuration-file-configyaml" class="md-nav__link">
    <span class="md-ellipsis">
      
        YAML Configuration File (config.yaml)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-yaml-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why YAML Configuration?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#environment-variable-overrides" class="md-nav__link">
    <span class="md-ellipsis">
      
        Environment Variable Overrides
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start-using-the-launcher-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      
        üöÄ Quick Start: Using the Launcher (Recommended)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üöÄ Quick Start: Using the Launcher (Recommended)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-use-the-launcher" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Use the Launcher?
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-runbat" class="md-nav__link">
    <span class="md-ellipsis">
      
        Using run.bat
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-the-launcher-does" class="md-nav__link">
    <span class="md-ellipsis">
      
        What the Launcher Does
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-output" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example Output
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-command-line-with-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        üöÄ Advanced: Command Line with Arguments
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üöÄ Advanced: Command Line with Arguments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#when-to-use-command-line-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        When to Use Command Line Arguments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-1-using-the-launcher-with-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method 1: Using the Launcher with Arguments
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#method-2-direct-python-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        Method 2: Direct Python Execution
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#available-command-line-arguments" class="md-nav__link">
    <span class="md-ellipsis">
      
        Available Command-Line Arguments
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        üèóÔ∏è Technical Architecture
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üèóÔ∏è Technical Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-design-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Design Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#intelligent-parsing-the-heart-of-the-tool" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìä Intelligent Parsing: The Heart of the Tool
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìä Intelligent Parsing: The Heart of the Tool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-intelligent-parsing-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Intelligent Parsing Matters
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parsing-strategy-textfsm-custom-fallback" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parsing Strategy: TextFSM + Custom Fallback
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-fixed-width-parser-parse_show_interfaces_status" class="md-nav__link">
    <span class="md-ellipsis">
      
        Custom Fixed-Width Parser: parse_show_interfaces_status()
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#port-mode-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        Port Mode Classification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#poe-enrichment-multi-source-data-fusion" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîå PoE Enrichment: Multi-Source Data Fusion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîå PoE Enrichment: Multi-Source Data Fusion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-poe-challenge" class="md-nav__link">
    <span class="md-ellipsis">
      
        The PoE Challenge
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interface-name-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interface Name Normalization
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#alias-based-lookup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Alias-Based Lookup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stale-port-detection-conservative-risk-assessment" class="md-nav__link">
    <span class="md-ellipsis">
      
        üö® Stale Port Detection: Conservative Risk Assessment
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üö® Stale Port Detection: Conservative Risk Assessment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-business-problem" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Business Problem
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conservative-detection-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conservative Detection Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#time-parsing-handling-cisco-duration-formats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Time Parsing: Handling Cisco Duration Formats
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#credentials-security" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîê Credentials &amp; Security
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jump-host-bastion-behaviour" class="md-nav__link">
    <span class="md-ellipsis">
      
        üõ∞Ô∏è Jump Host (Bastion) Behaviour
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#device-list-file" class="md-nav__link">
    <span class="md-ellipsis">
      
        ÔøΩÔ∏è Device List File
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      
        üöÄ Quick Start
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cli-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß≠ CLI Reference
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß≠ CLI Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-vs-optional" class="md-nav__link">
    <span class="md-ellipsis">
      
        Required vs Optional
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#portauditor-the-threaded-collection-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        ÔøΩüîå PortAuditor: The Threaded Collection Engine
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ÔøΩüîå PortAuditor: The Threaded Collection Engine">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-parallel-port-auditing-is-essential" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Parallel Port Auditing is Essential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#thread-safe-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Thread-Safe Architecture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#command-collection-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      
        Command Collection Strategy
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-intelligence-layer-port-classification" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Intelligence Layer: Port Classification
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#stale-logic-how-ports-are-flagged" class="md-nav__link">
    <span class="md-ellipsis">
      
        üõë Stale Logic ‚Äî How Ports Are Flagged
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-the-script-collects" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß™ What the Script Collects
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#excel-output-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        üì§ Excel Output Structure
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üì§ Excel Output Structure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-summary-sheet-first" class="md-nav__link">
    <span class="md-ellipsis">
      
        1) SUMMARY Sheet (First)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-one-sheet-per-device" class="md-nav__link">
    <span class="md-ellipsis">
      
        2) One Sheet Per Device
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formatting" class="md-nav__link">
    <span class="md-ellipsis">
      
        Formatting
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-concurrency" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚öôÔ∏è Performance &amp; Concurrency
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#logging-debug-and-errors" class="md-nav__link">
    <span class="md-ellipsis">
      
        ÔøΩ Logging, Debug, and Errors
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#extending-and-customizing" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîß Extending and Customizing
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      
        üîí Security Considerations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß© Compatibility
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß© Compatibility">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tested-devices" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tested Devices
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        ‚úÖ Examples
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#faqs" class="md-nav__link">
    <span class="md-ellipsis">
      
        üß† FAQs
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#learning-outcomes" class="md-nav__link">
    <span class="md-ellipsis">
      
        üéì Learning Outcomes
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéì Learning Outcomes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-code-patterns-demonstrated" class="md-nav__link">
    <span class="md-ellipsis">
      
        Key Code Patterns Demonstrated
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distribution-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        üöÄ Distribution &amp; Execution
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#licence" class="md-nav__link">
    <span class="md-ellipsis">
      
        üìã Licence
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#author" class="md-nav__link">
    <span class="md-ellipsis">
      
        üë§ Author
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scripts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Script Library
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../coming-soon/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Coming Soon
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Coming Soon
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coming-soon/IOS-XE%20Software%20Upgrade%20Orchestrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    IOS-XE Upgrade Orchestrator
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Legal
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Legal
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../legal/privacy-policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Privacy Policy
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../legal/terms-of-use/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Terms of Use
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../legal/licensing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Licensing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../legal/disclaimer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Disclaimer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../legal/brand/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Brand & Logo Usage
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    About
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
      
        <span class="md-tag">Access Switch</span>
      
    
      
      
      
      
        <span class="md-tag">Deep Dive</span>
      
    
      
      
      
      
        <span class="md-tag">Excel</span>
      
    
      
      
      
      
        <span class="md-tag">PoE</span>
      
    
      
      
      
      
        <span class="md-tag">Port Audit</span>
      
    
      
      
      
      
        <span class="md-tag">YAML</span>
      
    
  </nav>


  
  


<h1 id="deep-dive-access-switch-port-audit-tool">Deep Dive: Access Switch Port Audit Tool<a class="headerlink" href="#deep-dive-access-switch-port-audit-tool" title="Anchor link to this section">&para;</a></h1>
<h3 id="enterprise-port-intelligence-distilled-to-pure-python">"Enterprise Port Intelligence, Distilled to Pure Python."<a class="headerlink" href="#enterprise-port-intelligence-distilled-to-pure-python" title="Anchor link to this section">&para;</a></h3>
<p>A modular Python utility that connects to Cisco switches (optionally through an SSH jump host), collects comprehensive interface details, PoE information, and neighbor presence, then exports a professional, filters-only Excel workbook with a SUMMARY sheet and one sheet per device. Built for production reliability with <strong>YAML-based configuration</strong>, <strong>intelligent fallback parsing</strong>, and <strong>customizable credential management</strong>.</p>
<p><a class="md-button md-button--primary" href="https://github.com/Nautomation-Prime/Access_Switch_Audit"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg></span> View Source Code on GitHub</a></p>
<hr />
<h2 id="what-this-tool-does">‚ú® What This Tool Does<a class="headerlink" href="#what-this-tool-does" title="Anchor link to this section">&para;</a></h2>
<ul>
<li>Audits access ports across multiple Cisco switches in parallel</li>
<li>Normalises interface names (e.g., <code>GigabitEthernet1/0/1</code> ‚Üí <code>Gi1/0/1</code>) for cross-command matching</li>
<li>Enriches interfaces with:</li>
<li>PoE draw and state (<code>show power inline</code>)</li>
<li>LLDP/CDP neighbour presence (<code>show lldp neighbors detail</code>, <code>show cdp neighbors detail</code>)</li>
<li>Classifies port mode &amp; VLAN using <code>show interfaces status</code> (access / trunk / routed)</li>
<li>Flags stale access ports using conservative rules</li>
<li>Exports Excel with an at-a-glance SUMMARY and one sheet per device, with filters, frozen header, column auto-size, and conditional formatting</li>
<li>Shows a progress bar whilst running concurrent device jobs</li>
</ul>
<blockquote>
<p><strong>Design note:</strong> The workbook intentionally uses filters only (no Excel tables), and places SUMMARY first.</p>
</blockquote>
<hr />
<h2 id="the-nautomation-prime-philosophy-in-action">üéØ The Nautomation Prime Philosophy in Action<a class="headerlink" href="#the-nautomation-prime-philosophy-in-action" title="Anchor link to this section">&para;</a></h2>
<p>Before diving into the code, understand how every design decision reflects our three core principles:</p>
<h3 id="principle-1-line-by-line-transparency"><strong>Principle 1: Line-by-Line Transparency</strong><a class="headerlink" href="#principle-1-line-by-line-transparency" title="Anchor link to this section">&para;</a></h3>
<p>Every function in this tool includes explicit documentation of <em>what it does</em> and <em>why it's structured this way</em>. You'll see comments explaining the engineering tradeoffs‚Äîwhy we parse with TextFSM <em>and</em> maintain a fallback parser, why we use conservative stale-detection logic, and why conditional formatting in Excel matters for operations teams.</p>
<h3 id="principle-2-hardened-for-production"><strong>Principle 2: Hardened for Production</strong><a class="headerlink" href="#principle-2-hardened-for-production" title="Anchor link to this section">&para;</a></h3>
<p>Access layer audits run on infrastructure that cannot afford downtime. You'll notice patterns like concurrent connection pooling, per-device failure isolation, graceful fallbacks when commands fail, and secure credential rotation. These aren't "nice to have"‚Äîthey're mandatory for enterprise reliability.</p>
<h3 id="principle-3-vendor-neutral"><strong>Principle 3: Vendor-Neutral</strong><a class="headerlink" href="#principle-3-vendor-neutral" title="Anchor link to this section">&para;</a></h3>
<p>This tool is built on industry-standard Python libraries: <strong>Netmiko</strong> (multi-device SSH), <strong>Paramiko</strong> (jump host tunnelling), <strong>Pandas &amp; OpenPyXL</strong> (Excel generation), and <strong>TextFSM</strong> (intelligent parsing). Your skills remain portable across vendors.</p>
<hr />
<h2 id="project-layout">üß± Project Layout<a class="headerlink" href="#project-layout" title="Anchor link to this section">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-0-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-0-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-0-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-0-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-0-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-0-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-0-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-0-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-0-10">10</a></span>
<span class="normal"><a href="#__codelineno-0-11">11</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1"></a>.
<a id="__codelineno-0-2" name="__codelineno-0-2"></a>‚îú‚îÄ‚îÄ main.py                 # CLI entry point
<a id="__codelineno-0-3" name="__codelineno-0-3"></a>‚îú‚îÄ‚îÄ devices.txt             # Example device list
<a id="__codelineno-0-4" name="__codelineno-0-4"></a>‚îú‚îÄ‚îÄ config.yaml             # YAML configuration file (NEW!)
<a id="__codelineno-0-5" name="__codelineno-0-5"></a>‚îú‚îÄ‚îÄ README.md
<a id="__codelineno-0-6" name="__codelineno-0-6"></a>‚îî‚îÄ‚îÄ Modules/
<a id="__codelineno-0-7" name="__codelineno-0-7"></a>    ‚îú‚îÄ‚îÄ __init__.py
<a id="__codelineno-0-8" name="__codelineno-0-8"></a>    ‚îú‚îÄ‚îÄ config_loader.py    # YAML config parser with type-safe properties
<a id="__codelineno-0-9" name="__codelineno-0-9"></a>    ‚îú‚îÄ‚îÄ credentials.py      # Secure credential retrieval + fallbacks
<a id="__codelineno-0-10" name="__codelineno-0-10"></a>    ‚îú‚îÄ‚îÄ jump_manager.py     # SSH jump host (bastion) support
<a id="__codelineno-0-11" name="__codelineno-0-11"></a>    ‚îî‚îÄ‚îÄ netmiko_utils.py    # Netmiko connection wrapper(s)
</code></pre></div></td></tr></table></div>
<blockquote>
<p><strong>Note:</strong> The <code>Modules/*.py</code> files encapsulate most environment-specific behaviour. The new <code>config_loader.py</code> provides a clean interface to YAML-based configuration with validation and type safety.</p>
<p><strong>Key Improvement:</strong> Configuration is now in human-readable YAML format instead of Python code, making it safer and more accessible to non-developers.</p>
</blockquote>
<hr />
<h2 id="requirements">üì¶ Requirements<a class="headerlink" href="#requirements" title="Anchor link to this section">&para;</a></h2>
<ul>
<li><strong>Python:</strong> 3.8+</li>
<li><strong>Python packages:</strong></li>
<li><code>netmiko</code></li>
<li><code>paramiko</code></li>
<li><code>pandas</code></li>
<li><code>openpyxl</code></li>
<li><code>pywin32</code> (Windows only; used for Windows Credential Manager integration)</li>
</ul>
<p>Install with pip:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-1-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1"></a>pip<span class="w"> </span>install<span class="w"> </span>netmiko<span class="w"> </span>paramiko<span class="w"> </span>pandas<span class="w"> </span>openpyxl<span class="w"> </span>pywin32
</code></pre></div></td></tr></table></div></p>
<h3 id="optional-but-recommended">Optional but Recommended<a class="headerlink" href="#optional-but-recommended" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong>TextFSM templates</strong> (NTC templates) for robust parsing of <code>show interfaces</code> when <code>use_textfsm=True</code>.</li>
<li>If templates are available and the <code>NET_TEXTFSM</code> environment variable points to them, parsing accuracy improves.</li>
<li>If not available, the script still works and falls back where needed (e.g., it has its own fixed-width parser for <code>show interfaces status</code>).</li>
</ul>
<hr />
<h2 id="configuration-system">‚öôÔ∏è Configuration System<a class="headerlink" href="#configuration-system" title="Anchor link to this section">&para;</a></h2>
<p>The tool uses a <strong>modern YAML-based configuration system</strong> introduced in recent updates.</p>
<h3 id="yaml-configuration-file-configyaml">YAML Configuration File (config.yaml)<a class="headerlink" href="#yaml-configuration-file-configyaml" title="Anchor link to this section">&para;</a></h3>
<p>All configurable settings are centralized in <code>config.yaml</code> at the project root. The configuration is loaded via <code>Modules/config_loader.py</code> which provides type-safe property accessors.</p>
<p><strong>Key Configuration Categories:</strong></p>
<p><strong>1. Network Settings:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-2-1">1</a></span>
<span class="normal"><a href="#__codelineno-2-2">2</a></span>
<span class="normal"><a href="#__codelineno-2-3">3</a></span>
<span class="normal"><a href="#__codelineno-2-4">4</a></span>
<span class="normal"><a href="#__codelineno-2-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nt">network</span><span class="p">:</span>
<a id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">  </span><span class="nt">jump_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jump-gateway.example.com&quot;</span><span class="w">  </span><span class="c1"># Default bastion/jump host</span>
<a id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">  </span><span class="nt">device_type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cisco_ios&quot;</span><span class="w">                </span><span class="c1"># Netmiko device type</span>
<a id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">  </span><span class="nt">ssh_port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">22</span><span class="w">                            </span><span class="c1"># SSH port</span>
<a id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">  </span><span class="nt">read_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w">                        </span><span class="c1"># Command read timeout</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>2. Credential Settings:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nt">credentials</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">  </span><span class="nt">cred_target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;MyApp/ADM&quot;</span><span class="w">  </span><span class="c1"># Windows Credential Manager target</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">  </span><span class="nt">enable_target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">          </span><span class="c1"># Optional enable secret target</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>3. Performance &amp; Concurrency:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="nt">concurrency</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">  </span><span class="nt">default_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w">        </span><span class="c1"># Max concurrent device sessions</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">  </span><span class="nt">retry_attempts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span><span class="w">          </span><span class="c1"># Connection retry count</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">  </span><span class="nt">retry_base_wait</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class="w">         </span><span class="c1"># Base wait time for exponential backoff</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>4. Excel Output:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1">1</a></span>
<span class="normal"><a href="#__codelineno-5-2">2</a></span>
<span class="normal"><a href="#__codelineno-5-3">3</a></span>
<span class="normal"><a href="#__codelineno-5-4">4</a></span>
<span class="normal"><a href="#__codelineno-5-5">5</a></span>
<span class="normal"><a href="#__codelineno-5-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">  </span><span class="nt">default_filename</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;audit.xlsx&quot;</span><span class="w">  </span><span class="c1"># Default output filename</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="nt">excel_formatting</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">  </span><span class="nt">min_column_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">  </span><span class="nt">max_column_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>5. Stale Port Detection:</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-6-1">1</a></span>
<span class="normal"><a href="#__codelineno-6-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nt">stale_detection</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">  </span><span class="nt">default_stale_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span><span class="w">  </span><span class="c1"># Days threshold for stale ports</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="why-yaml-configuration">Why YAML Configuration?<a class="headerlink" href="#why-yaml-configuration" title="Anchor link to this section">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Benefit</th>
<th style="text-align: left;">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Human-Readable</strong></td>
<td style="text-align: left;">No Python knowledge required to modify settings</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Version Control Friendly</strong></td>
<td style="text-align: left;">Plain text format works seamlessly with Git</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Safer</strong></td>
<td style="text-align: left;">No code execution risk (pure data)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Validated</strong></td>
<td style="text-align: left;">Config loader validates types and provides defaults</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Hierarchical</strong></td>
<td style="text-align: left;">Natural grouping of related settings</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Documented</strong></td>
<td style="text-align: left;">Inline comments explain each setting</td>
</tr>
</tbody>
</table>
<h3 id="environment-variable-overrides">Environment Variable Overrides<a class="headerlink" href="#environment-variable-overrides" title="Anchor link to this section">&para;</a></h3>
<p>Specific settings can be overridden at runtime via environment variables (primarily for the jump host):</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c"># Override jump host at runtime</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="nv">$env:JUMP_HOST</span> <span class="p">=</span> <span class="s2">&quot;temp-bastion.example.com&quot;</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p><strong>Best Practice:</strong> Use <code>config.yaml</code> for organizational defaults; use CLI arguments (<code>--direct</code>, <code>--workers</code>, etc.) for per-run overrides.</p>
</blockquote>
<hr />
<h2 id="quick-start-using-the-launcher-recommended">üöÄ Quick Start: Using the Launcher (Recommended)<a class="headerlink" href="#quick-start-using-the-launcher-recommended" title="Anchor link to this section">&para;</a></h2>
<p>The repository now includes a <strong>professional Windows batch launcher</strong> (<code>run.bat</code>) that provides the easiest way to run the tool with default settings.</p>
<h3 id="why-use-the-launcher">Why Use the Launcher?<a class="headerlink" href="#why-use-the-launcher" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong>Zero configuration required</strong> - Just double-click or run from command line</li>
<li><strong>Automatic validation</strong> - Checks for Python environment and required files before execution</li>
<li><strong>Helpful diagnostics</strong> - Clear error messages if something is missing</li>
<li><strong>Professional interface</strong> - Clean output with status indicators and progress messages</li>
<li><strong>Safe execution</strong> - Validates environment before running the script</li>
</ul>
<h3 id="using-runbat">Using run.bat<a class="headerlink" href="#using-runbat" title="Anchor link to this section">&para;</a></h3>
<p><strong>Option 1: Double-click</strong></p>
<p>Simply double-click <code>run.bat</code> in Windows Explorer to launch the tool with default behavior.</p>
<p><strong>Option 2: Command Line (Default Behavior)</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-8-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1"></a>run.bat
</code></pre></div></td></tr></table></div>
<p>This runs the Access Switch Audit with all default settings from <code>config.yaml</code>.</p>
<h3 id="what-the-launcher-does">What the Launcher Does<a class="headerlink" href="#what-the-launcher-does" title="Anchor link to this section">&para;</a></h3>
<ol>
<li><strong>Validates the environment:</strong></li>
<li>Checks that the <code>portable_env</code> virtual environment exists</li>
<li>Verifies Python executable is present</li>
<li>Confirms <code>main.py</code> exists</li>
<li>
<p>Validates <code>config.yaml</code> and <code>devices.txt</code> are present</p>
</li>
<li>
<p><strong>Provides clear feedback:</strong></p>
</li>
<li>Shows [OK] for successful checks</li>
<li>Shows [WARNING] for missing optional files with option to continue</li>
<li>Shows [ERROR] for critical missing components</li>
<li>
<p>Displays helpful troubleshooting tips on failure</p>
</li>
<li>
<p><strong>Runs the tool:</strong></p>
</li>
<li>Activates the virtual environment</li>
<li>Executes the main script</li>
<li>Captures and displays the exit code</li>
<li>Provides common troubleshooting tips if errors occur</li>
</ol>
<h3 id="example-output">Example Output<a class="headerlink" href="#example-output" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-9-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-9-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-9-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-9-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-9-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-9-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-9-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-9-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-9-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-9-10">10</a></span>
<span class="normal"><a href="#__codelineno-9-11">11</a></span>
<span class="normal"><a href="#__codelineno-9-12">12</a></span>
<span class="normal"><a href="#__codelineno-9-13">13</a></span>
<span class="normal"><a href="#__codelineno-9-14">14</a></span>
<span class="normal"><a href="#__codelineno-9-15">15</a></span>
<span class="normal"><a href="#__codelineno-9-16">16</a></span>
<span class="normal"><a href="#__codelineno-9-17">17</a></span>
<span class="normal"><a href="#__codelineno-9-18">18</a></span>
<span class="normal"><a href="#__codelineno-9-19">19</a></span>
<span class="normal"><a href="#__codelineno-9-20">20</a></span>
<span class="normal"><a href="#__codelineno-9-21">21</a></span>
<span class="normal"><a href="#__codelineno-9-22">22</a></span>
<span class="normal"><a href="#__codelineno-9-23">23</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1"></a>================================================================================
<a id="__codelineno-9-2" name="__codelineno-9-2"></a>                  ACCESS SWITCH AUDIT TOOL
<a id="__codelineno-9-3" name="__codelineno-9-3"></a>================================================================================
<a id="__codelineno-9-4" name="__codelineno-9-4"></a>
<a id="__codelineno-9-5" name="__codelineno-9-5"></a>Starting validation checks...
<a id="__codelineno-9-6" name="__codelineno-9-6"></a>
<a id="__codelineno-9-7" name="__codelineno-9-7"></a>[OK] Python Environment: Found at portable_env\Scripts\python.exe
<a id="__codelineno-9-8" name="__codelineno-9-8"></a>[OK] Required support files found
<a id="__codelineno-9-9" name="__codelineno-9-9"></a>[OK] All validation checks passed
<a id="__codelineno-9-10" name="__codelineno-9-10"></a>
<a id="__codelineno-9-11" name="__codelineno-9-11"></a>================================================================================
<a id="__codelineno-9-12" name="__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13"></a>Running Access Switch Audit...
<a id="__codelineno-9-14" name="__codelineno-9-14"></a>
<a id="__codelineno-9-15" name="__codelineno-9-15"></a>================================================================================
<a id="__codelineno-9-16" name="__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17"></a>[Script output appears here]
<a id="__codelineno-9-18" name="__codelineno-9-18"></a>
<a id="__codelineno-9-19" name="__codelineno-9-19"></a>================================================================================
<a id="__codelineno-9-20" name="__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21"></a>[SUCCESS] Script completed successfully
<a id="__codelineno-9-22" name="__codelineno-9-22"></a>
<a id="__codelineno-9-23" name="__codelineno-9-23"></a>================================================================================
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="advanced-command-line-with-arguments">üöÄ Advanced: Command Line with Arguments<a class="headerlink" href="#advanced-command-line-with-arguments" title="Anchor link to this section">&para;</a></h2>
<p>For advanced users who need to <strong>customize behavior beyond the defaults</strong>, you can still run the tool directly with Python and command-line arguments.</p>
<h3 id="when-to-use-command-line-arguments">When to Use Command Line Arguments<a class="headerlink" href="#when-to-use-command-line-arguments" title="Anchor link to this section">&para;</a></h3>
<p>Use <code>python main.py</code> with arguments when you need to:</p>
<ul>
<li>Override default settings from <code>config.yaml</code></li>
<li>Specify a different devices file</li>
<li>Change output filename</li>
<li>Adjust worker thread count</li>
<li>Enable debug mode</li>
<li>Force direct connections (bypass jump host)</li>
</ul>
<h3 id="method-1-using-the-launcher-with-arguments">Method 1: Using the Launcher with Arguments<a class="headerlink" href="#method-1-using-the-launcher-with-arguments" title="Anchor link to this section">&para;</a></h3>
<p>You can pass arguments to <code>run.bat</code> and they will be forwarded to the Python script:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-10-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1"></a>run.bat --devices my-switches.txt --output custom-audit.xlsx --workers 5
</code></pre></div></td></tr></table></div>
<h3 id="method-2-direct-python-execution">Method 2: Direct Python Execution<a class="headerlink" href="#method-2-direct-python-execution" title="Anchor link to this section">&para;</a></h3>
<p>Activate the virtual environment and run Python directly:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-11-1">1</a></span>
<span class="normal"><a href="#__codelineno-11-2">2</a></span>
<span class="normal"><a href="#__codelineno-11-3">3</a></span>
<span class="normal"><a href="#__codelineno-11-4">4</a></span>
<span class="normal"><a href="#__codelineno-11-5">5</a></span>
<span class="normal"><a href="#__codelineno-11-6">6</a></span>
<span class="normal"><a href="#__codelineno-11-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1"></a><span class="c1"># Windows</span>
<a id="__codelineno-11-2" name="__codelineno-11-2"></a>portable_env<span class="se">\S</span>cripts<span class="se">\a</span>ctivate
<a id="__codelineno-11-3" name="__codelineno-11-3"></a>python<span class="w"> </span>main.py<span class="w"> </span>--devices<span class="w"> </span>my-switches.txt<span class="w"> </span>--output<span class="w"> </span>audit-report.xlsx
<a id="__codelineno-11-4" name="__codelineno-11-4"></a>
<a id="__codelineno-11-5" name="__codelineno-11-5"></a><span class="c1"># Linux/macOS  </span>
<a id="__codelineno-11-6" name="__codelineno-11-6"></a><span class="nb">source</span><span class="w"> </span>portable_env/bin/activate
<a id="__codelineno-11-7" name="__codelineno-11-7"></a>python<span class="w"> </span>main.py<span class="w"> </span>--devices<span class="w"> </span>my-switches.txt<span class="w"> </span>--output<span class="w"> </span>audit-report.xlsx
</code></pre></div></td></tr></table></div>
<h3 id="available-command-line-arguments">Available Command-Line Arguments<a class="headerlink" href="#available-command-line-arguments" title="Anchor link to this section">&para;</a></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Argument</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>--devices</code>, <code>-d</code></td>
<td style="text-align: left;">Path to devices file</td>
<td style="text-align: left;"><code>devices.txt</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>--output</code>, <code>-o</code></td>
<td style="text-align: left;">Output Excel filename</td>
<td style="text-align: left;"><code>audit.xlsx</code></td>
</tr>
<tr>
<td style="text-align: left;"><code>--workers</code>, <code>-w</code></td>
<td style="text-align: left;">Number of concurrent threads</td>
<td style="text-align: left;">10</td>
</tr>
<tr>
<td style="text-align: left;"><code>--stale-days</code></td>
<td style="text-align: left;">Days threshold for stale ports</td>
<td style="text-align: left;">30</td>
</tr>
<tr>
<td style="text-align: left;"><code>--direct</code></td>
<td style="text-align: left;">Skip jump host, connect directly</td>
<td style="text-align: left;">False</td>
</tr>
<tr>
<td style="text-align: left;"><code>--debug</code></td>
<td style="text-align: left;">Enable debug-level logging</td>
<td style="text-align: left;">False</td>
</tr>
</tbody>
</table>
<p><strong>Example: Custom audit with direct connections:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-12-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1"></a>python<span class="w"> </span>main.py<span class="w"> </span>--devices<span class="w"> </span>critical-switches.txt<span class="w"> </span>--output<span class="w"> </span>critical-audit.xlsx<span class="w"> </span>--direct<span class="w"> </span>--debug
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="technical-architecture">üèóÔ∏è Technical Architecture<a class="headerlink" href="#technical-architecture" title="Anchor link to this section">&para;</a></h2>
<p>The tool operates as a modular Python application with six primary components:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Component</th>
<th style="text-align: left;">Responsibility</th>
<th style="text-align: left;">Why It Matters</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Config Loader</strong></td>
<td style="text-align: left;">YAML parsing and validation with type-safe properties</td>
<td style="text-align: left;">Settings are centralized, validated, and safe from code injection</td>
</tr>
<tr>
<td style="text-align: left;"><strong>CredentialManager</strong></td>
<td style="text-align: left;">Secure credential retrieval from OS stores</td>
<td style="text-align: left;">Passwords never touch plaintext or config files</td>
</tr>
<tr>
<td style="text-align: left;"><strong>JumpManager</strong></td>
<td style="text-align: left;">Persistent SSH tunnelling through a bastion host</td>
<td style="text-align: left;">Centralises network access control; supports air-gapped environments</td>
</tr>
<tr>
<td style="text-align: left;"><strong>PortAuditor (Netmiko)</strong></td>
<td style="text-align: left;">Parallel device SSH connections and command collection</td>
<td style="text-align: left;">Audits 20+ switches in minutes, not hours</td>
</tr>
<tr>
<td style="text-align: left;"><strong>PortIntelligence</strong></td>
<td style="text-align: left;">Multi-source port classification and risk flagging</td>
<td style="text-align: left;">Detects stale, misconfigured, or problematic ports automatically</td>
</tr>
<tr>
<td style="text-align: left;"><strong>ExcelReporter</strong></td>
<td style="text-align: left;">Professional, templated workbook generation</td>
<td style="text-align: left;">Operations teams get insights immediately, not raw data dumps</td>
</tr>
</tbody>
</table>
<h3 id="key-design-patterns">Key Design Patterns<a class="headerlink" href="#key-design-patterns" title="Anchor link to this section">&para;</a></h3>
<p><strong>1. Modular Configuration:</strong>
- Settings separated from code (YAML vs Python)
- Config loader provides validation and type safety
- Environment-specific overrides supported</p>
<p><strong>2. Intelligent Fallback Parsing:</strong>
- Primary: TextFSM templates (when available)
- Fallback: Custom fixed-width parsers
- Ensures reliability even without external dependencies</p>
<p><strong>3. Multi-Threaded Execution:</strong>
- ThreadPoolExecutor with configurable worker count
- Thread-safe data accumulation with locks
- Per-device failure isolation</p>
<p><strong>4. Graceful Error Handling:</strong>
- Exponential backoff retry logic
- Per-device error capture (doesn't stop entire audit)
- Comprehensive logging for troubleshooting</p>
<hr />
<h2 id="intelligent-parsing-the-heart-of-the-tool">üìä Intelligent Parsing: The Heart of the Tool<a class="headerlink" href="#intelligent-parsing-the-heart-of-the-tool" title="Anchor link to this section">&para;</a></h2>
<h3 id="why-intelligent-parsing-matters">Why Intelligent Parsing Matters<a class="headerlink" href="#why-intelligent-parsing-matters" title="Anchor link to this section">&para;</a></h3>
<p><strong>The Problem:</strong> Cisco CLI output varies by device model, IOS version, and platform. <code>show interfaces status</code> might be formatted differently on a Catalyst 2960 vs a 9300. TextFSM templates might not exist for your specific platform.</p>
<p><strong>The Solution:</strong> Multi-tier parsing strategy with intelligent fallbacks.</p>
<h3 id="parsing-strategy-textfsm-custom-fallback">Parsing Strategy: TextFSM + Custom Fallback<a class="headerlink" href="#parsing-strategy-textfsm-custom-fallback" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-13-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-13-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-13-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-13-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-13-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-13-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-13-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-13-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-13-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-13-10">10</a></span>
<span class="normal"><a href="#__codelineno-13-11">11</a></span>
<span class="normal"><a href="#__codelineno-13-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">get_interfaces_via_show_interfaces</span><span class="p">(</span><span class="n">conn</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
<a id="__codelineno-13-2" name="__codelineno-13-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-13-3" name="__codelineno-13-3"></a><span class="sd">    Use TextFSM to parse &#39;show interfaces&#39; for all ports.</span>
<a id="__codelineno-13-4" name="__codelineno-13-4"></a><span class="sd">    Falls back gracefully if templates unavailable.</span>
<a id="__codelineno-13-5" name="__codelineno-13-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-13-6" name="__codelineno-13-6"></a>    <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-13-7" name="__codelineno-13-7"></a>        <span class="n">output</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">send_command</span><span class="p">(</span><span class="s2">&quot;show interfaces&quot;</span><span class="p">,</span> <span class="n">use_textfsm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<a id="__codelineno-13-8" name="__codelineno-13-8"></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
<a id="__codelineno-13-9" name="__codelineno-13-9"></a>            <span class="k">return</span> <span class="n">output</span>
<a id="__codelineno-13-10" name="__codelineno-13-10"></a>        <span class="k">return</span> <span class="p">[]</span>
<a id="__codelineno-13-11" name="__codelineno-13-11"></a>    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<a id="__codelineno-13-12" name="__codelineno-13-12"></a>        <span class="k">return</span> <span class="p">[]</span>  <span class="c1"># Graceful degradation</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why This Approach:</strong>
- TextFSM provides structured parsing when templates exist
- Returns empty list (not exception) if parsing fails
- Main logic continues with custom parsers</p>
<h3 id="custom-fixed-width-parser-parse_show_interfaces_status">Custom Fixed-Width Parser: <code>parse_show_interfaces_status()</code><a class="headerlink" href="#custom-fixed-width-parser-parse_show_interfaces_status" title="Anchor link to this section">&para;</a></h3>
<p>This is the <strong>authoritative source</strong> for port mode and VLAN classification.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-14-1">1</a></span>
<span class="normal"><a href="#__codelineno-14-2">2</a></span>
<span class="normal"><a href="#__codelineno-14-3">3</a></span>
<span class="normal"><a href="#__codelineno-14-4">4</a></span>
<span class="normal"><a href="#__codelineno-14-5">5</a></span>
<span class="normal"><a href="#__codelineno-14-6">6</a></span>
<span class="normal"><a href="#__codelineno-14-7">7</a></span>
<span class="normal"><a href="#__codelineno-14-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">parse_show_interfaces_status</span><span class="p">(</span><span class="n">output</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-14-3" name="__codelineno-14-3"></a><span class="sd">    Robust fixed-width parser for &#39;show interfaces status&#39;.</span>
<a id="__codelineno-14-4" name="__codelineno-14-4"></a><span class="sd">    Handles:</span>
<a id="__codelineno-14-5" name="__codelineno-14-5"></a><span class="sd">    - Multiple header formats</span>
<a id="__codelineno-14-6" name="__codelineno-14-6"></a><span class="sd">    - Variable column widths</span>
<a id="__codelineno-14-7" name="__codelineno-14-7"></a><span class="sd">    - Missing/malformed data</span>
<a id="__codelineno-14-8" name="__codelineno-14-8"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Step 1: Identify Header Row</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-15-1">1</a></span>
<span class="normal"><a href="#__codelineno-15-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">is_header</span><span class="p">(</span><span class="n">ln</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<a id="__codelineno-15-2" name="__codelineno-15-2"></a>    <span class="k">return</span> <span class="p">(</span><span class="s2">&quot;Port&quot;</span> <span class="ow">in</span> <span class="n">ln</span> <span class="ow">and</span> <span class="s2">&quot;Status&quot;</span> <span class="ow">in</span> <span class="n">ln</span> <span class="ow">and</span> <span class="s2">&quot;Vlan&quot;</span> <span class="ow">in</span> <span class="n">ln</span> <span class="ow">and</span> <span class="s2">&quot;Speed&quot;</span> <span class="ow">in</span> <span class="n">ln</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why:</strong> Header detection must be flexible. Different IOS versions capitalize differently.</p>
<p><strong>Step 2: Extract Column Positions</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-16-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-16-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-16-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-16-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-16-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-16-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-16-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-16-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-16-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-16-10">10</a></span>
<span class="normal"><a href="#__codelineno-16-11">11</a></span>
<span class="normal"><a href="#__codelineno-16-12">12</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_find_columns</span><span class="p">(</span><span class="n">header_line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">slice</span><span class="p">]:</span>
<a id="__codelineno-16-2" name="__codelineno-16-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-16-3" name="__codelineno-16-3"></a><span class="sd">    Calculate exact character positions for each column.</span>
<a id="__codelineno-16-4" name="__codelineno-16-4"></a><span class="sd">    Returns slice objects for substring extraction.</span>
<a id="__codelineno-16-5" name="__codelineno-16-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-16-6" name="__codelineno-16-6"></a>    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Port&quot;</span><span class="p">,</span> <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="s2">&quot;Status&quot;</span><span class="p">,</span> <span class="s2">&quot;Vlan&quot;</span><span class="p">,</span> <span class="s2">&quot;Duplex&quot;</span><span class="p">,</span> <span class="s2">&quot;Speed&quot;</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">]</span>
<a id="__codelineno-16-7" name="__codelineno-16-7"></a>    <span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-16-8" name="__codelineno-16-8"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">tok</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tokens</span><span class="p">):</span>
<a id="__codelineno-16-9" name="__codelineno-16-9"></a>        <span class="n">start</span> <span class="o">=</span> <span class="n">header_line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">tok</span><span class="p">)</span>
<a id="__codelineno-16-10" name="__codelineno-16-10"></a>        <span class="n">end</span> <span class="o">=</span> <span class="n">header_line</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span> <span class="k">else</span> <span class="nb">len</span><span class="p">(</span><span class="n">header_line</span><span class="p">)</span>
<a id="__codelineno-16-11" name="__codelineno-16-11"></a>        <span class="n">positions</span><span class="p">[</span><span class="n">tok</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span>
<a id="__codelineno-16-12" name="__codelineno-16-12"></a>    <span class="k">return</span> <span class="n">positions</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why This Matters:</strong>
- Fixed-width parsing is more reliable than regex for tabular CLI output
- Dynamically calculated positions adapt to slight formatting variations
- Slice objects provide clean substring extraction</p>
<p><strong>Step 3: Parse Data Rows</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-17-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-17-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-17-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-17-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-17-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-17-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-17-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-17-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-17-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-17-10">10</a></span>
<span class="normal"><a href="#__codelineno-17-11">11</a></span>
<span class="normal"><a href="#__codelineno-17-12">12</a></span>
<span class="normal"><a href="#__codelineno-17-13">13</a></span>
<span class="normal"><a href="#__codelineno-17-14">14</a></span>
<span class="normal"><a href="#__codelineno-17-15">15</a></span>
<span class="normal"><a href="#__codelineno-17-16">16</a></span>
<span class="normal"><a href="#__codelineno-17-17">17</a></span>
<span class="normal"><a href="#__codelineno-17-18">18</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1"></a><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2"></a>    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">((</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="s2">&quot;Port&quot;</span><span class="p">))</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
<a id="__codelineno-17-3" name="__codelineno-17-3"></a>        <span class="k">continue</span>  <span class="c1"># Skip separators and empty lines</span>
<a id="__codelineno-17-4" name="__codelineno-17-4"></a>
<a id="__codelineno-17-5" name="__codelineno-17-5"></a>    <span class="n">record</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-17-6" name="__codelineno-17-6"></a>    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">col_slice</span> <span class="ow">in</span> <span class="n">slices</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<a id="__codelineno-17-7" name="__codelineno-17-7"></a>        <span class="n">record</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">col_slice</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<a id="__codelineno-17-8" name="__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9"></a>    <span class="c1"># Normalize status values</span>
<a id="__codelineno-17-10" name="__codelineno-17-10"></a>    <span class="n">status_raw</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-17-11" name="__codelineno-17-11"></a>    <span class="k">if</span> <span class="s1">&#39;connect&#39;</span> <span class="ow">in</span> <span class="n">status_raw</span><span class="p">:</span>
<a id="__codelineno-17-12" name="__codelineno-17-12"></a>        <span class="n">record</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;connected&#39;</span>
<a id="__codelineno-17-13" name="__codelineno-17-13"></a>    <span class="k">elif</span> <span class="s1">&#39;notconnect&#39;</span> <span class="ow">in</span> <span class="n">status_raw</span><span class="p">:</span>
<a id="__codelineno-17-14" name="__codelineno-17-14"></a>        <span class="n">record</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;notconnect&#39;</span>
<a id="__codelineno-17-15" name="__codelineno-17-15"></a>    <span class="k">elif</span> <span class="s1">&#39;disabled&#39;</span> <span class="ow">in</span> <span class="n">status_raw</span><span class="p">:</span>
<a id="__codelineno-17-16" name="__codelineno-17-16"></a>        <span class="n">record</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span>
<a id="__codelineno-17-17" name="__codelineno-17-17"></a>    <span class="k">elif</span> <span class="s1">&#39;err&#39;</span> <span class="ow">in</span> <span class="n">status_raw</span><span class="p">:</span>
<a id="__codelineno-17-18" name="__codelineno-17-18"></a>        <span class="n">record</span><span class="p">[</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;err-disabled&#39;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why Status Normalization:</strong>
- Different IOS versions use slight variations ("connected" vs "connect")
- Normalized values enable reliable conditional formatting in Excel
- Consistent categorization across device types</p>
<h3 id="port-mode-classification">Port Mode Classification<a class="headerlink" href="#port-mode-classification" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-18-1">1</a></span>
<span class="normal"><a href="#__codelineno-18-2">2</a></span>
<span class="normal"><a href="#__codelineno-18-3">3</a></span>
<span class="normal"><a href="#__codelineno-18-4">4</a></span>
<span class="normal"><a href="#__codelineno-18-5">5</a></span>
<span class="normal"><a href="#__codelineno-18-6">6</a></span>
<span class="normal"><a href="#__codelineno-18-7">7</a></span>
<span class="normal"><a href="#__codelineno-18-8">8</a></span>
<span class="normal"><a href="#__codelineno-18-9">9</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1"></a><span class="c1"># Determine mode from VLAN column</span>
<a id="__codelineno-18-2" name="__codelineno-18-2"></a><span class="n">vlan_value</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;vlan&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-18-3" name="__codelineno-18-3"></a>
<a id="__codelineno-18-4" name="__codelineno-18-4"></a><span class="k">if</span> <span class="n">vlan_value</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;trunk&#39;</span><span class="p">,</span> <span class="s1">&#39;rspan&#39;</span><span class="p">):</span>
<a id="__codelineno-18-5" name="__codelineno-18-5"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;trunk&#39;</span>
<a id="__codelineno-18-6" name="__codelineno-18-6"></a><span class="k">elif</span> <span class="n">vlan_value</span> <span class="o">==</span> <span class="s1">&#39;routed&#39;</span><span class="p">:</span>
<a id="__codelineno-18-7" name="__codelineno-18-7"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;routed&#39;</span>
<a id="__codelineno-18-8" name="__codelineno-18-8"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-18-9" name="__codelineno-18-9"></a>    <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;access&#39;</span>  <span class="c1"># Default assumption</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why This Logic:</strong>
- VLAN column is the most reliable indicator of port mode
- Trunk ports show "trunk" or "rspan" in VLAN field
- Routed ports show "routed"
- Everything else is access (may show VLAN number)</p>
<hr />
<h2 id="poe-enrichment-multi-source-data-fusion">üîå PoE Enrichment: Multi-Source Data Fusion<a class="headerlink" href="#poe-enrichment-multi-source-data-fusion" title="Anchor link to this section">&para;</a></h2>
<h3 id="the-poe-challenge">The PoE Challenge<a class="headerlink" href="#the-poe-challenge" title="Anchor link to this section">&para;</a></h3>
<p><strong>Problem:</strong> PoE data (<code>show power inline</code>) uses different interface naming than <code>show interfaces status</code>. Example:
- Status command: <code>Gi1/0/1</code>
- PoE command: <code>GigabitEthernet1/0/1</code></p>
<p><strong>Solution:</strong> Interface name aliasing and multi-key lookups.</p>
<h3 id="interface-name-normalization">Interface Name Normalization<a class="headerlink" href="#interface-name-normalization" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-19-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-19-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-19-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-19-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-19-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-19-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-19-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-19-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-19-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-19-10">10</a></span>
<span class="normal"><a href="#__codelineno-19-11">11</a></span>
<span class="normal"><a href="#__codelineno-19-12">12</a></span>
<span class="normal"><a href="#__codelineno-19-13">13</a></span>
<span class="normal"><a href="#__codelineno-19-14">14</a></span>
<span class="normal"><a href="#__codelineno-19-15">15</a></span>
<span class="normal"><a href="#__codelineno-19-16">16</a></span>
<span class="normal"><a href="#__codelineno-19-17">17</a></span>
<span class="normal"><a href="#__codelineno-19-18">18</a></span>
<span class="normal"><a href="#__codelineno-19-19">19</a></span>
<span class="normal"><a href="#__codelineno-19-20">20</a></span>
<span class="normal"><a href="#__codelineno-19-21">21</a></span>
<span class="normal"><a href="#__codelineno-19-22">22</a></span>
<span class="normal"><a href="#__codelineno-19-23">23</a></span>
<span class="normal"><a href="#__codelineno-19-24">24</a></span>
<span class="normal"><a href="#__codelineno-19-25">25</a></span>
<span class="normal"><a href="#__codelineno-19-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">normalize_ifname</span><span class="p">(</span><span class="n">ifname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-19-2" name="__codelineno-19-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-19-3" name="__codelineno-19-3"></a><span class="sd">    Normalize interface names to canonical short and long forms.</span>
<a id="__codelineno-19-4" name="__codelineno-19-4"></a><span class="sd">    Returns: (short_form, long_form)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5"></a><span class="sd">    Example: &quot;Gi1/0/1&quot; ‚Üí (&quot;Gi1/0/1&quot;, &quot;GigabitEthernet1/0/1&quot;)</span>
<a id="__codelineno-19-6" name="__codelineno-19-6"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-19-7" name="__codelineno-19-7"></a>    <span class="c1"># Extract prefix and port number</span>
<a id="__codelineno-19-8" name="__codelineno-19-8"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;([A-Za-z]+)([0-9/\.]+.*)&quot;</span><span class="p">,</span> <span class="n">ifname</span><span class="p">)</span>
<a id="__codelineno-19-9" name="__codelineno-19-9"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
<a id="__codelineno-19-10" name="__codelineno-19-10"></a>        <span class="k">return</span> <span class="p">(</span><span class="n">ifname</span><span class="p">,</span> <span class="n">ifname</span><span class="p">)</span>
<a id="__codelineno-19-11" name="__codelineno-19-11"></a>
<a id="__codelineno-19-12" name="__codelineno-19-12"></a>    <span class="n">prefix_raw</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-19-13" name="__codelineno-19-13"></a>    <span class="n">rest</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-19-14" name="__codelineno-19-14"></a>
<a id="__codelineno-19-15" name="__codelineno-19-15"></a>    <span class="c1"># Map to short form</span>
<a id="__codelineno-19-16" name="__codelineno-19-16"></a>    <span class="n">short_prefix</span> <span class="o">=</span> <span class="n">_IF_MAP</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">prefix_raw</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span> <span class="n">prefix_raw</span><span class="p">)</span>
<a id="__codelineno-19-17" name="__codelineno-19-17"></a>
<a id="__codelineno-19-18" name="__codelineno-19-18"></a>    <span class="c1"># Generate long form</span>
<a id="__codelineno-19-19" name="__codelineno-19-19"></a>    <span class="n">long_prefix</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-19-20" name="__codelineno-19-20"></a>        <span class="s2">&quot;Gi&quot;</span><span class="p">:</span> <span class="s2">&quot;GigabitEthernet&quot;</span><span class="p">,</span>
<a id="__codelineno-19-21" name="__codelineno-19-21"></a>        <span class="s2">&quot;Fa&quot;</span><span class="p">:</span> <span class="s2">&quot;FastEthernet&quot;</span><span class="p">,</span>
<a id="__codelineno-19-22" name="__codelineno-19-22"></a>        <span class="s2">&quot;Te&quot;</span><span class="p">:</span> <span class="s2">&quot;TenGigabitEthernet&quot;</span><span class="p">,</span>
<a id="__codelineno-19-23" name="__codelineno-19-23"></a>        <span class="s2">&quot;Eth&quot;</span><span class="p">:</span> <span class="s2">&quot;Ethernet&quot;</span><span class="p">,</span>
<a id="__codelineno-19-24" name="__codelineno-19-24"></a>    <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">short_prefix</span><span class="p">,</span> <span class="n">prefix_raw</span><span class="p">)</span>
<a id="__codelineno-19-25" name="__codelineno-19-25"></a>
<a id="__codelineno-19-26" name="__codelineno-19-26"></a>    <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">short_prefix</span><span class="si">}{</span><span class="n">rest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">long_prefix</span><span class="si">}{</span><span class="n">rest</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why This Matters:</strong>
- Enables reliable cross-command matching
- Handles all common Cisco interface types
- Works across different IOS versions and platforms</p>
<h3 id="alias-based-lookup">Alias-Based Lookup<a class="headerlink" href="#alias-based-lookup" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-20-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-20-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-20-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-20-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-20-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-20-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-20-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-20-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-20-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-20-10">10</a></span>
<span class="normal"><a href="#__codelineno-20-11">11</a></span>
<span class="normal"><a href="#__codelineno-20-12">12</a></span>
<span class="normal"><a href="#__codelineno-20-13">13</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">all_aliases</span><span class="p">(</span><span class="n">ifname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<a id="__codelineno-20-2" name="__codelineno-20-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-20-3" name="__codelineno-20-3"></a><span class="sd">    Return all possible alias strings for an interface.</span>
<a id="__codelineno-20-4" name="__codelineno-20-4"></a><span class="sd">    Used for PoE data matching.</span>
<a id="__codelineno-20-5" name="__codelineno-20-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6"></a>    <span class="n">short</span><span class="p">,</span> <span class="n">long</span> <span class="o">=</span> <span class="n">normalize_ifname</span><span class="p">(</span><span class="n">ifname</span><span class="p">)</span>
<a id="__codelineno-20-7" name="__codelineno-20-7"></a>    <span class="k">return</span> <span class="p">[</span><span class="n">short</span><span class="p">,</span> <span class="n">long</span><span class="p">,</span> <span class="n">ifname</span><span class="p">]</span>  <span class="c1"># Try all variations</span>
<a id="__codelineno-20-8" name="__codelineno-20-8"></a>
<a id="__codelineno-20-9" name="__codelineno-20-9"></a><span class="c1"># During PoE enrichment:</span>
<a id="__codelineno-20-10" name="__codelineno-20-10"></a><span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">all_aliases</span><span class="p">(</span><span class="n">port_name</span><span class="p">):</span>
<a id="__codelineno-20-11" name="__codelineno-20-11"></a>    <span class="k">if</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">poe_map</span><span class="p">:</span>
<a id="__codelineno-20-12" name="__codelineno-20-12"></a>        <span class="n">poe_data</span> <span class="o">=</span> <span class="n">poe_map</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span>
<a id="__codelineno-20-13" name="__codelineno-20-13"></a>        <span class="k">break</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why Multiple Aliases:</strong>
- Different commands use different naming conventions
- Maximizes successful PoE data correlation
- Prevents data loss due to naming mismatches</p>
<hr />
<h2 id="stale-port-detection-conservative-risk-assessment">üö® Stale Port Detection: Conservative Risk Assessment<a class="headerlink" href="#stale-port-detection-conservative-risk-assessment" title="Anchor link to this section">&para;</a></h2>
<h3 id="the-business-problem">The Business Problem<a class="headerlink" href="#the-business-problem" title="Anchor link to this section">&para;</a></h3>
<p><strong>Scenario:</strong> You have 1,000 switch ports. How do you identify which ones are truly unused vs. temporarily disconnected vs. connected to equipment that's powered off?</p>
<p><strong>False Positives Are Expensive:</strong>
- Marking an active port as "stale" disrupts operations
- Users lose network access
- Help desk tickets spike</p>
<p><strong>False Negatives Waste Resources:</strong>
- Unused ports consume switch capacity
- Security risk (unauthorized devices can plug in)</p>
<h3 id="conservative-detection-strategy">Conservative Detection Strategy<a class="headerlink" href="#conservative-detection-strategy" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-21-1">1</a></span>
<span class="normal"><a href="#__codelineno-21-2">2</a></span>
<span class="normal"><a href="#__codelineno-21-3">3</a></span>
<span class="normal"><a href="#__codelineno-21-4">4</a></span>
<span class="normal"><a href="#__codelineno-21-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_categorize_port</span><span class="p">(</span><span class="n">row</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">stale_days</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<a id="__codelineno-21-2" name="__codelineno-21-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-21-3" name="__codelineno-21-3"></a><span class="sd">    Classify port as: active, stale, or available.</span>
<a id="__codelineno-21-4" name="__codelineno-21-4"></a><span class="sd">    Uses conservative logic to minimize false positives.</span>
<a id="__codelineno-21-5" name="__codelineno-21-5"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Rule 1: Only Classify Access Ports</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-22-1">1</a></span>
<span class="normal"><a href="#__codelineno-22-2">2</a></span>
<span class="normal"><a href="#__codelineno-22-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1"></a><span class="n">mode</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Mode&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-22-2" name="__codelineno-22-2"></a><span class="k">if</span> <span class="n">mode</span> <span class="o">!=</span> <span class="s1">&#39;access&#39;</span><span class="p">:</span>
<a id="__codelineno-22-3" name="__codelineno-22-3"></a>    <span class="k">return</span> <span class="s1">&#39;active&#39;</span>  <span class="c1"># Trunk and routed ports are infrastructure</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why:</strong> Trunk and routed ports connect switches to each other. They should never be flagged as stale.</p>
<p><strong>Rule 2: Connected Ports ‚Äî Check Activity</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-23-1">1</a></span>
<span class="normal"><a href="#__codelineno-23-2">2</a></span>
<span class="normal"><a href="#__codelineno-23-3">3</a></span>
<span class="normal"><a href="#__codelineno-23-4">4</a></span>
<span class="normal"><a href="#__codelineno-23-5">5</a></span>
<span class="normal"><a href="#__codelineno-23-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1"></a><span class="n">status</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Status&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<a id="__codelineno-23-2" name="__codelineno-23-2"></a><span class="k">if</span> <span class="n">status</span> <span class="o">==</span> <span class="s1">&#39;connected&#39;</span><span class="p">:</span>
<a id="__codelineno-23-3" name="__codelineno-23-3"></a>    <span class="n">last_input_secs</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Last Input Seconds&#39;</span><span class="p">)</span>
<a id="__codelineno-23-4" name="__codelineno-23-4"></a>    <span class="k">if</span> <span class="n">last_input_secs</span> <span class="ow">and</span> <span class="n">last_input_secs</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">stale_days</span> <span class="o">*</span> <span class="mi">86400</span><span class="p">):</span>
<a id="__codelineno-23-5" name="__codelineno-23-5"></a>        <span class="k">return</span> <span class="s1">&#39;stale&#39;</span>
<a id="__codelineno-23-6" name="__codelineno-23-6"></a>    <span class="k">return</span> <span class="s1">&#39;active&#39;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why:</strong>
- Port is physically connected
- But hasn't passed traffic in N days
- Likely a powered-off device or misconfigured endpoint</p>
<p><strong>Rule 3: Disconnected Ports ‚Äî Check for Indicators</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-24-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-24-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-24-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-24-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-24-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-24-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-24-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-24-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-24-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-24-10">10</a></span>
<span class="normal"><a href="#__codelineno-24-11">11</a></span>
<span class="normal"><a href="#__codelineno-24-12">12</a></span>
<span class="normal"><a href="#__codelineno-24-13">13</a></span>
<span class="normal"><a href="#__codelineno-24-14">14</a></span>
<span class="normal"><a href="#__codelineno-24-15">15</a></span>
<span class="normal"><a href="#__codelineno-24-16">16</a></span>
<span class="normal"><a href="#__codelineno-24-17">17</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1"></a><span class="k">if</span> <span class="n">status</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;notconnect&#39;</span><span class="p">,</span> <span class="s1">&#39;disabled&#39;</span><span class="p">,</span> <span class="s1">&#39;err-disabled&#39;</span><span class="p">):</span>
<a id="__codelineno-24-2" name="__codelineno-24-2"></a>    <span class="c1"># Conservative: require BOTH conditions to flag as stale</span>
<a id="__codelineno-24-3" name="__codelineno-24-3"></a>    <span class="n">has_poe</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;PoE Power (W)&#39;</span><span class="p">)</span>
<a id="__codelineno-24-4" name="__codelineno-24-4"></a>    <span class="n">has_neighbor</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;LLDP/CDP Neighbor&#39;</span><span class="p">)</span>
<a id="__codelineno-24-5" name="__codelineno-24-5"></a>
<a id="__codelineno-24-6" name="__codelineno-24-6"></a>    <span class="n">poe_w</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-24-7" name="__codelineno-24-7"></a>    <span class="k">if</span> <span class="n">has_poe</span><span class="p">:</span>
<a id="__codelineno-24-8" name="__codelineno-24-8"></a>        <span class="k">try</span><span class="p">:</span>
<a id="__codelineno-24-9" name="__codelineno-24-9"></a>            <span class="n">poe_w</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">has_poe</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
<a id="__codelineno-24-10" name="__codelineno-24-10"></a>        <span class="k">except</span><span class="p">:</span>
<a id="__codelineno-24-11" name="__codelineno-24-11"></a>            <span class="k">pass</span>
<a id="__codelineno-24-12" name="__codelineno-24-12"></a>
<a id="__codelineno-24-13" name="__codelineno-24-13"></a>    <span class="c1"># Stale only if: no PoE draw AND no neighbor</span>
<a id="__codelineno-24-14" name="__codelineno-24-14"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">poe_w</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">poe_w</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">has_neighbor</span><span class="p">:</span>
<a id="__codelineno-24-15" name="__codelineno-24-15"></a>        <span class="k">return</span> <span class="s1">&#39;stale&#39;</span>
<a id="__codelineno-24-16" name="__codelineno-24-16"></a>
<a id="__codelineno-24-17" name="__codelineno-24-17"></a>    <span class="k">return</span> <span class="s1">&#39;available&#39;</span>  <span class="c1"># May be in use (PoE or neighbor present)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why This Conservative Approach:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Indicator</th>
<th style="text-align: left;">Interpretation</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>PoE draw &gt; 0</strong></td>
<td style="text-align: left;">Device is powered (IP phone, camera, AP)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>LLDP/CDP neighbor</strong></td>
<td style="text-align: left;">Device is network-aware (switch, phone, AP)</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Both absent</strong></td>
<td style="text-align: left;">Likely unused cable or dead device</td>
</tr>
</tbody>
</table>
<p><strong>Example Scenarios:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Status</th>
<th style="text-align: left;">PoE</th>
<th style="text-align: left;">Neighbor</th>
<th style="text-align: left;">Last Input</th>
<th style="text-align: left;">Classification</th>
<th style="text-align: left;">Reasoning</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">connected</td>
<td style="text-align: left;">7.0W</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">10 days</td>
<td style="text-align: left;"><strong>active</strong></td>
<td style="text-align: left;">IP phone actively drawing power</td>
</tr>
<tr>
<td style="text-align: left;">connected</td>
<td style="text-align: left;">0W</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">45 days</td>
<td style="text-align: left;"><strong>stale</strong></td>
<td style="text-align: left;">Connected but no traffic for 45+ days</td>
</tr>
<tr>
<td style="text-align: left;">notconnect</td>
<td style="text-align: left;">0W</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;"><strong>stale</strong></td>
<td style="text-align: left;">Disconnected, no indicators of use</td>
</tr>
<tr>
<td style="text-align: left;">notconnect</td>
<td style="text-align: left;">6.5W</td>
<td style="text-align: left;">No</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;"><strong>available</strong></td>
<td style="text-align: left;">PoE device present (might be powered off)</td>
</tr>
<tr>
<td style="text-align: left;">notconnect</td>
<td style="text-align: left;">0W</td>
<td style="text-align: left;">Yes</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;"><strong>available</strong></td>
<td style="text-align: left;">Neighbor detected (might be rebooting)</td>
</tr>
</tbody>
</table>
<h3 id="time-parsing-handling-cisco-duration-formats">Time Parsing: Handling Cisco Duration Formats<a class="headerlink" href="#time-parsing-handling-cisco-duration-formats" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-25-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-25-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-25-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-25-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-25-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-25-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-25-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-25-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-25-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-25-10">10</a></span>
<span class="normal"><a href="#__codelineno-25-11">11</a></span>
<span class="normal"><a href="#__codelineno-25-12">12</a></span>
<span class="normal"><a href="#__codelineno-25-13">13</a></span>
<span class="normal"><a href="#__codelineno-25-14">14</a></span>
<span class="normal"><a href="#__codelineno-25-15">15</a></span>
<span class="normal"><a href="#__codelineno-25-16">16</a></span>
<span class="normal"><a href="#__codelineno-25-17">17</a></span>
<span class="normal"><a href="#__codelineno-25-18">18</a></span>
<span class="normal"><a href="#__codelineno-25-19">19</a></span>
<span class="normal"><a href="#__codelineno-25-20">20</a></span>
<span class="normal"><a href="#__codelineno-25-21">21</a></span>
<span class="normal"><a href="#__codelineno-25-22">22</a></span>
<span class="normal"><a href="#__codelineno-25-23">23</a></span>
<span class="normal"><a href="#__codelineno-25-24">24</a></span>
<span class="normal"><a href="#__codelineno-25-25">25</a></span>
<span class="normal"><a href="#__codelineno-25-26">26</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">_parse_last_input_seconds</span><span class="p">(</span><span class="n">s</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-25-2" name="__codelineno-25-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-25-3" name="__codelineno-25-3"></a><span class="sd">    Parse Cisco &#39;Last input&#39; timer into seconds.</span>
<a id="__codelineno-25-4" name="__codelineno-25-4"></a><span class="sd">    Handles: &quot;00:01:23&quot;, &quot;1d2h30m&quot;, &quot;never&quot;</span>
<a id="__codelineno-25-5" name="__codelineno-25-5"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-25-6" name="__codelineno-25-6"></a>    <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="ow">or</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<a id="__codelineno-25-7" name="__codelineno-25-7"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">s</span> <span class="ow">or</span> <span class="n">s</span> <span class="o">==</span> <span class="s2">&quot;never&quot;</span><span class="p">:</span>
<a id="__codelineno-25-8" name="__codelineno-25-8"></a>        <span class="k">return</span> <span class="kc">None</span>
<a id="__codelineno-25-9" name="__codelineno-25-9"></a>
<a id="__codelineno-25-10" name="__codelineno-25-10"></a>    <span class="c1"># Format 1: hh:mm:ss</span>
<a id="__codelineno-25-11" name="__codelineno-25-11"></a>    <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^\d{1,2}:\d</span><span class="si">{2}</span><span class="s2">:\d</span><span class="si">{2}</span><span class="s2">$&quot;</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
<a id="__codelineno-25-12" name="__codelineno-25-12"></a>        <span class="n">hh</span><span class="p">,</span> <span class="n">mm</span><span class="p">,</span> <span class="n">ss</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
<a id="__codelineno-25-13" name="__codelineno-25-13"></a>        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">hh</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">mm</span><span class="p">)</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">ss</span><span class="p">)</span>
<a id="__codelineno-25-14" name="__codelineno-25-14"></a>
<a id="__codelineno-25-15" name="__codelineno-25-15"></a>    <span class="c1"># Format 2: Compact duration (1y2w3d4h5m6s)</span>
<a id="__codelineno-25-16" name="__codelineno-25-16"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">_TIME_RE</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
<a id="__codelineno-25-17" name="__codelineno-25-17"></a>    <span class="k">if</span> <span class="n">m</span><span class="p">:</span>
<a id="__codelineno-25-18" name="__codelineno-25-18"></a>        <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-19" name="__codelineno-25-19"></a>        <span class="n">w</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-20" name="__codelineno-25-20"></a>        <span class="n">d</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-21" name="__codelineno-25-21"></a>        <span class="n">h</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;h&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-22" name="__codelineno-25-22"></a>        <span class="n">m_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;m&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-23" name="__codelineno-25-23"></a>        <span class="n">s_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-25-24" name="__codelineno-25-24"></a>
<a id="__codelineno-25-25" name="__codelineno-25-25"></a>        <span class="n">days</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="mi">365</span> <span class="o">+</span> <span class="n">w</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">+</span> <span class="n">d</span>
<a id="__codelineno-25-26" name="__codelineno-25-26"></a>        <span class="k">return</span> <span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">h</span> <span class="o">*</span> <span class="mi">3600</span> <span class="o">+</span> <span class="n">m_val</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">+</span> <span class="n">s_val</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why Multiple Format Support:</strong>
- Different IOS versions use different time formats
- Ensures accurate stale detection across all platforms</p>
<hr />
<h2 id="credentials-security">üîê Credentials &amp; Security<a class="headerlink" href="#credentials-security" title="Anchor link to this section">&para;</a></h2>
<p>The script retrieves device credentials using <code>Modules/credentials.py</code>:</p>
<ul>
<li><strong>Primary:</strong> Windows Credential Manager (target name from <code>config.yaml</code>: default <code>MyApp/ADM</code>)</li>
<li><strong>Fallback:</strong> Interactive prompt for username and password (secure, not echoed)</li>
<li><strong>Enable secret:</strong> Retrieved by <code>get_enable_secret()</code> if configured in <code>config.yaml</code>, otherwise not required</li>
</ul>
<blockquote>
<p><strong>Note:</strong> If you are running on Linux/macOS, ensure <code>credentials.py</code> prompts for credentials or implements your preferred secure store. On Windows, <code>pywin32</code> enables Credential Manager access.</p>
<p><strong>Important:</strong> Never hard-code credentials in the repository. Use the secure store or environment prompts.</p>
<p><strong>Configuration:</strong> Credential Manager targets are set in <code>config.yaml</code> under the <code>credentials</code> section:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-26-1">1</a></span>
<span class="normal"><a href="#__codelineno-26-2">2</a></span>
<span class="normal"><a href="#__codelineno-26-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1"></a><span class="nt">credentials</span><span class="p">:</span>
<a id="__codelineno-26-2" name="__codelineno-26-2"></a><span class="w">  </span><span class="nt">cred_target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;MyApp/ADM&quot;</span><span class="w">  </span><span class="c1"># Primary credential target</span>
<a id="__codelineno-26-3" name="__codelineno-26-3"></a><span class="w">  </span><span class="nt">enable_target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">          </span><span class="c1"># Optional enable secret target</span>
</code></pre></div></td></tr></table></div>
</blockquote>
<hr />
<h2 id="jump-host-bastion-behaviour">üõ∞Ô∏è Jump Host (Bastion) Behaviour<a class="headerlink" href="#jump-host-bastion-behaviour" title="Anchor link to this section">&para;</a></h2>
<ul>
<li><code>main.py</code> reads <code>jump_host</code> from the <code>network</code> section of <code>config.yaml</code></li>
<li><strong>Default:</strong> the script uses the jump host if <code>--direct</code> is not supplied</li>
<li><code>--direct</code> will skip the jump host entirely and attempt direct SSH connections</li>
</ul>
<p>Example configuration in <code>config.yaml</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-27-1">1</a></span>
<span class="normal"><a href="#__codelineno-27-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1"></a><span class="nt">network</span><span class="p">:</span>
<a id="__codelineno-27-2" name="__codelineno-27-2"></a><span class="w">  </span><span class="nt">jump_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jump-gateway.example.com&quot;</span><span class="w">  </span><span class="c1"># or &quot;&quot; to disable by default</span>
</code></pre></div></td></tr></table></div></p>
<p>The <code>JumpManager</code> maintains a persistent SSH session to the bastion and proxies device connections through it.</p>
<p><strong>How JumpManager Works:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-28-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-28-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-28-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-28-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-28-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-28-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-28-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-28-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-28-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-28-10">10</a></span>
<span class="normal"><a href="#__codelineno-28-11">11</a></span>
<span class="normal"><a href="#__codelineno-28-12">12</a></span>
<span class="normal"><a href="#__codelineno-28-13">13</a></span>
<span class="normal"><a href="#__codelineno-28-14">14</a></span>
<span class="normal"><a href="#__codelineno-28-15">15</a></span>
<span class="normal"><a href="#__codelineno-28-16">16</a></span>
<span class="normal"><a href="#__codelineno-28-17">17</a></span>
<span class="normal"><a href="#__codelineno-28-18">18</a></span>
<span class="normal"><a href="#__codelineno-28-19">19</a></span>
<span class="normal"><a href="#__codelineno-28-20">20</a></span>
<span class="normal"><a href="#__codelineno-28-21">21</a></span>
<span class="normal"><a href="#__codelineno-28-22">22</a></span>
<span class="normal"><a href="#__codelineno-28-23">23</a></span>
<span class="normal"><a href="#__codelineno-28-24">24</a></span>
<span class="normal"><a href="#__codelineno-28-25">25</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">JumpManager</span><span class="p">:</span>
<a id="__codelineno-28-2" name="__codelineno-28-2"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jump_host</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">username</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">password</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<a id="__codelineno-28-3" name="__codelineno-28-3"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">jump_host</span> <span class="o">=</span> <span class="n">jump_host</span>
<a id="__codelineno-28-4" name="__codelineno-28-4"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="n">username</span>
<a id="__codelineno-28-5" name="__codelineno-28-5"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
<a id="__codelineno-28-6" name="__codelineno-28-6"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Paramiko SSH client</span>
<a id="__codelineno-28-7" name="__codelineno-28-7"></a>
<a id="__codelineno-28-8" name="__codelineno-28-8"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-28-9" name="__codelineno-28-9"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Establish persistent SSH connection to bastion.&quot;&quot;&quot;</span>
<a id="__codelineno-28-10" name="__codelineno-28-10"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span class="n">paramiko</span><span class="o">.</span><span class="n">SSHClient</span><span class="p">()</span>
<a id="__codelineno-28-11" name="__codelineno-28-11"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">set_missing_host_key_policy</span><span class="p">(</span><span class="n">paramiko</span><span class="o">.</span><span class="n">AutoAddPolicy</span><span class="p">())</span>
<a id="__codelineno-28-12" name="__codelineno-28-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
<a id="__codelineno-28-13" name="__codelineno-28-13"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">jump_host</span><span class="p">,</span>
<a id="__codelineno-28-14" name="__codelineno-28-14"></a>            <span class="n">username</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">username</span><span class="p">,</span>
<a id="__codelineno-28-15" name="__codelineno-28-15"></a>            <span class="n">password</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">,</span>
<a id="__codelineno-28-16" name="__codelineno-28-16"></a>            <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span>
<a id="__codelineno-28-17" name="__codelineno-28-17"></a>        <span class="p">)</span>
<a id="__codelineno-28-18" name="__codelineno-28-18"></a>
<a id="__codelineno-28-19" name="__codelineno-28-19"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">open_channel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_ip</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">target_port</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<a id="__codelineno-28-20" name="__codelineno-28-20"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Open direct-tcpip channel through bastion.&quot;&quot;&quot;</span>
<a id="__codelineno-28-21" name="__codelineno-28-21"></a>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">get_transport</span><span class="p">()</span><span class="o">.</span><span class="n">open_channel</span><span class="p">(</span>
<a id="__codelineno-28-22" name="__codelineno-28-22"></a>            <span class="s1">&#39;direct-tcpip&#39;</span><span class="p">,</span>
<a id="__codelineno-28-23" name="__codelineno-28-23"></a>            <span class="p">(</span><span class="n">target_ip</span><span class="p">,</span> <span class="n">target_port</span><span class="p">),</span>
<a id="__codelineno-28-24" name="__codelineno-28-24"></a>            <span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-28-25" name="__codelineno-28-25"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why direct-tcpip Channel:</strong>
- No port forwarding needed on bastion
- All traffic stays within authenticated SSH session
- Cleaner than local port forwarding
- Works with restrictive bastion configurations</p>
<hr />
<h2 id="device-list-file">ÔøΩÔ∏è Device List File<a class="headerlink" href="#device-list-file" title="Anchor link to this section">&para;</a></h2>
<p>Provide a plain-text file with one device per line. Lines that are blank or start with <code>#</code> are ignored.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-29-1">1</a></span>
<span class="normal"><a href="#__codelineno-29-2">2</a></span>
<span class="normal"><a href="#__codelineno-29-3">3</a></span>
<span class="normal"><a href="#__codelineno-29-4">4</a></span>
<span class="normal"><a href="#__codelineno-29-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1"></a># devices.txt
<a id="__codelineno-29-2" name="__codelineno-29-2"></a>192.0.2.11
<a id="__codelineno-29-3" name="__codelineno-29-3"></a>192.0.2.12  # inline comments are not parsed; this whole token must be a host/IP only
<a id="__codelineno-29-4" name="__codelineno-29-4"></a>core-switch-01
<a id="__codelineno-29-5" name="__codelineno-29-5"></a>access-sw-22
</code></pre></div></td></tr></table></div>
<blockquote>
<p><strong>Note:</strong> Hostnames must be resolvable from the machine (or via the jump host, depending on your SSH setup).</p>
</blockquote>
<hr />
<h2 id="quick-start">üöÄ Quick Start<a class="headerlink" href="#quick-start" title="Anchor link to this section">&para;</a></h2>
<ol>
<li>Install dependencies (see Requirements).</li>
<li>Create <code>devices.txt</code> with your targets (see Device list file).</li>
<li>(Optional) Configure <code>Modules/config.py</code> with your <code>JUMP_HOST</code>.</li>
<li>Run the audit:</li>
</ol>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-30-1">1</a></span>
<span class="normal"><a href="#__codelineno-30-2">2</a></span>
<span class="normal"><a href="#__codelineno-30-3">3</a></span>
<span class="normal"><a href="#__codelineno-30-4">4</a></span>
<span class="normal"><a href="#__codelineno-30-5">5</a></span>
<span class="normal"><a href="#__codelineno-30-6">6</a></span>
<span class="normal"><a href="#__codelineno-30-7">7</a></span>
<span class="normal"><a href="#__codelineno-30-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1"></a><span class="c1"># Using jump host from config.yaml</span>
<a id="__codelineno-30-2" name="__codelineno-30-2"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>--devices<span class="w"> </span>devices.txt<span class="w"> </span>--output<span class="w"> </span>access_port_audit.xlsx
<a id="__codelineno-30-3" name="__codelineno-30-3"></a>
<a id="__codelineno-30-4" name="__codelineno-30-4"></a><span class="c1"># Direct connections (no bastion), 5 workers, different stale threshold</span>
<a id="__codelineno-30-5" name="__codelineno-30-5"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>--direct<span class="w"> </span>-w<span class="w"> </span><span class="m">5</span><span class="w"> </span>--stale-days<span class="w"> </span><span class="m">60</span><span class="w"> </span>-d<span class="w"> </span>devices.txt<span class="w"> </span>-o<span class="w"> </span>results.xlsx
<a id="__codelineno-30-6" name="__codelineno-30-6"></a>
<a id="__codelineno-30-7" name="__codelineno-30-7"></a><span class="c1"># Verbose debugging</span>
<a id="__codelineno-30-8" name="__codelineno-30-8"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>--debug<span class="w"> </span>-d<span class="w"> </span>devices.txt
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="cli-reference">üß≠ CLI Reference<a class="headerlink" href="#cli-reference" title="Anchor link to this section">&para;</a></h2>
<p><code>main.py</code> exposes the following command-line options:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-31-1">1</a></span>
<span class="normal"><a href="#__codelineno-31-2">2</a></span>
<span class="normal"><a href="#__codelineno-31-3">3</a></span>
<span class="normal"><a href="#__codelineno-31-4">4</a></span>
<span class="normal"><a href="#__codelineno-31-5">5</a></span>
<span class="normal"><a href="#__codelineno-31-6">6</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1"></a>--devices, -d    (required)  Path to the devices file (one IP/hostname per line; &#39;#&#39; comments allowed)
<a id="__codelineno-31-2" name="__codelineno-31-2"></a>--output,  -o    (optional)  Output Excel file name. Default: audit.xlsx
<a id="__codelineno-31-3" name="__codelineno-31-3"></a>--workers, -w    (optional)  Max concurrent device sessions (threads). Default: 10
<a id="__codelineno-31-4" name="__codelineno-31-4"></a>--stale-days     (optional)  Days threshold for stale access ports. 0 disables stale flagging. Default: 30
<a id="__codelineno-31-5" name="__codelineno-31-5"></a>--direct         (optional)  Connect directly (do not use jump host)
<a id="__codelineno-31-6" name="__codelineno-31-6"></a>--debug          (optional)  Enable verbose logging/prints
</code></pre></div></td></tr></table></div>
<h3 id="required-vs-optional">Required vs Optional<a class="headerlink" href="#required-vs-optional" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong>Required:</strong> <code>--devices</code></li>
<li><strong>Optional:</strong> everything else</li>
</ul>
<hr />
<h2 id="portauditor-the-threaded-collection-engine">ÔøΩüîå PortAuditor: The Threaded Collection Engine<a class="headerlink" href="#portauditor-the-threaded-collection-engine" title="Anchor link to this section">&para;</a></h2>
<h3 id="why-parallel-port-auditing-is-essential">Why Parallel Port Auditing is Essential<a class="headerlink" href="#why-parallel-port-auditing-is-essential" title="Anchor link to this section">&para;</a></h3>
<p><strong>The Problem:</strong> Auditing 50 switches serially with 5 commands per device = 250 SSH round-trips. At 2 seconds per connection, that's 8+ minutes of waiting.</p>
<p><strong>The Solution:</strong> Thread pool with 10 concurrent workers = 10 simultaneous SSH sessions. Same 50 switches audited in 1-2 minutes.</p>
<h3 id="thread-safe-architecture">Thread-Safe Architecture<a class="headerlink" href="#thread-safe-architecture" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-32-1">1</a></span>
<span class="normal"><a href="#__codelineno-32-2">2</a></span>
<span class="normal"><a href="#__codelineno-32-3">3</a></span>
<span class="normal"><a href="#__codelineno-32-4">4</a></span>
<span class="normal"><a href="#__codelineno-32-5">5</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1"></a><span class="c1"># Thread-safe accumulators (protected by locks)</span>
<a id="__codelineno-32-2" name="__codelineno-32-2"></a><span class="bp">self</span><span class="o">.</span><span class="n">device_records</span> <span class="o">=</span> <span class="p">[]</span>       <span class="c1"># Parsed results: one row per device</span>
<a id="__codelineno-32-3" name="__codelineno-32-3"></a><span class="bp">self</span><span class="o">.</span><span class="n">interface_details</span> <span class="o">=</span> <span class="p">[]</span>    <span class="c1"># Detailed per-interface data</span>
<a id="__codelineno-32-4" name="__codelineno-32-4"></a><span class="bp">self</span><span class="o">.</span><span class="n">failed_devices</span> <span class="o">=</span> <span class="p">{}</span>       <span class="c1"># {ip: error_message}</span>
<a id="__codelineno-32-5" name="__codelineno-32-5"></a><span class="bp">self</span><span class="o">.</span><span class="n">progress_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>  <span class="c1"># Protects shared state</span>
</code></pre></div></td></tr></table></div>
<p><strong>Why Thread Locks Matter:</strong>
- Without locks, multiple threads writing to the same list causes data corruption
- The lock ensures atomic append operations
- Minimal lock contention because we hold locks for microseconds, not seconds</p>
<h3 id="command-collection-strategy">Command Collection Strategy<a class="headerlink" href="#command-collection-strategy" title="Anchor link to this section">&para;</a></h3>
<p>For each device, the tool collects five commands in sequence:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Command</th>
<th style="text-align: left;">Purpose</th>
<th style="text-align: left;">Fallback</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>show version</code></td>
<td style="text-align: left;">Extract hostname, OS version, uptime</td>
<td style="text-align: left;">Use management IP if hostname parse fails</td>
</tr>
<tr>
<td style="text-align: left;"><code>show interfaces</code></td>
<td style="text-align: left;">Parse interface types, error counters, activity</td>
<td style="text-align: left;">Use TextFSM if available; use internal parser otherwise</td>
</tr>
<tr>
<td style="text-align: left;"><code>show interfaces status</code></td>
<td style="text-align: left;">Extract port mode, VLAN, status using fixed-width parsing</td>
<td style="text-align: left;">Built-in fallback parser (no external dependency)</td>
</tr>
<tr>
<td style="text-align: left;"><code>show power inline</code></td>
<td style="text-align: left;">Collect PoE admin/oper state and power draw</td>
<td style="text-align: left;">Empty dict if device is non-PoE or command fails</td>
</tr>
<tr>
<td style="text-align: left;"><code>show cdp/lldp neighbors detail</code></td>
<td style="text-align: left;">Detect peer devices on each port</td>
<td style="text-align: left;">Boolean flag (true if neighbour present)</td>
</tr>
</tbody>
</table>
<p><strong>Why This Command Set?</strong>
- Comprehensive but minimal: each command provides data no other command offers
- Covers the three dimensions of port health: <em>configuration</em> (mode/VLAN), <em>activity</em> (errors, last input), <em>attachment</em> (PoE, neighbours)</p>
<h3 id="the-intelligence-layer-port-classification">The Intelligence Layer: Port Classification<a class="headerlink" href="#the-intelligence-layer-port-classification" title="Anchor link to this section">&para;</a></h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-33-1">1</a></span>
<span class="normal"><a href="#__codelineno-33-2">2</a></span>
<span class="normal"><a href="#__codelineno-33-3">3</a></span>
<span class="normal"><a href="#__codelineno-33-4">4</a></span>
<span class="normal"><a href="#__codelineno-33-5">5</a></span>
<span class="normal"><a href="#__codelineno-33-6">6</a></span>
<span class="normal"><a href="#__codelineno-33-7">7</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">classify_port</span><span class="p">(</span><span class="n">interface_record</span><span class="p">):</span>
<a id="__codelineno-33-2" name="__codelineno-33-2"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-33-3" name="__codelineno-33-3"></a><span class="sd">    Assign a port to one of three categories:</span>
<a id="__codelineno-33-4" name="__codelineno-33-4"></a><span class="sd">    - &#39;access&#39;: Single VLAN, typically hosts</span>
<a id="__codelineno-33-5" name="__codelineno-33-5"></a><span class="sd">    - &#39;trunk&#39;: Multiple VLANs, typically uplinks</span>
<a id="__codelineno-33-6" name="__codelineno-33-6"></a><span class="sd">    - &#39;routed&#39;: No VLAN (layer 3), typically inter-device links</span>
<a id="__codelineno-33-7" name="__codelineno-33-7"></a><span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
<p><strong>Classification Logic:</strong></p>
<p>From <code>show interfaces status</code>, inspect the VLAN column:</p>
<ul>
<li>If <code>trunk</code> or <code>rspan</code> ‚Üí <strong>Trunk</strong></li>
<li>If <code>routed</code> ‚Üí <strong>Routed</strong></li>
<li>Otherwise ‚Üí <strong>Access</strong></li>
</ul>
<p><strong>Why This Matters:</strong>
- Different port types require different stale-detection rules
- Access ports should be connected to hosts; trunk ports connect infrastructure
- This classification enables intelligent filtering and reporting</p>
<hr />
<h2 id="stale-logic-how-ports-are-flagged">üõë Stale Logic ‚Äî How Ports Are Flagged<a class="headerlink" href="#stale-logic-how-ports-are-flagged" title="Anchor link to this section">&para;</a></h2>
<p>A conservative approach is used only for ports in <code>access</code> mode and when <code>--stale-days &gt; 0</code>:</p>
<ul>
<li><strong>If Status = <code>connected</code></strong> ‚Üí mark stale = True only if <code>Last input ‚â• &lt;stale-days&gt;</code></li>
<li><strong>If Status ‚â† <code>connected</code></strong> ‚Üí mark stale = True when both conditions hold:</li>
<li>No PoE draw (PoE power is blank/<code>-</code>/0.0), and</li>
<li>No LLDP/CDP neighbour present on the port</li>
</ul>
<p>This tends to avoid false positives on trunk/routed ports and on access ports actively in use.</p>
<blockquote>
<p><strong>Note:</strong> You can disable stale flagging entirely by setting <code>--stale-days 0</code>.</p>
</blockquote>
<hr />
<h2 id="what-the-script-collects">üß™ What the Script Collects<a class="headerlink" href="#what-the-script-collects" title="Anchor link to this section">&para;</a></h2>
<p>For each device the script attempts to gather:</p>
<ul>
<li><strong>Hostname</strong> (from <code>show running-config | include ^hostname</code> or CLI prompt fallback)</li>
<li><strong>Interfaces</strong> via TextFSM (<code>show interfaces</code>) when available</li>
<li><strong>Port mode &amp; VLAN</strong> via a robust, fixed-width parser of <code>show interfaces status</code></li>
<li><strong>PoE details:</strong> admin/oper state, power draw (W), class, device (<code>show power inline</code>)</li>
<li><strong>Neighbour presence:</strong> LLDP/CDP seen on the port (boolean)</li>
<li><strong>Error counters:</strong> input, output, CRC (from <code>show interfaces</code> parsed data)</li>
<li><strong>Activity indicator:</strong> "Last input" time (seconds parsed when present)</li>
</ul>
<hr />
<h2 id="excel-output-structure">üì§ Excel Output Structure<a class="headerlink" href="#excel-output-structure" title="Anchor link to this section">&para;</a></h2>
<p>The workbook contains:</p>
<h3 id="1-summary-sheet-first">1) <code>SUMMARY</code> Sheet (First)<a class="headerlink" href="#1-summary-sheet-first" title="Anchor link to this section">&para;</a></h3>
<ul>
<li>One row per device, with a final TOTAL row (sums numeric columns)</li>
<li>Columns include:</li>
<li><code>Device</code>, <code>Mgmt IP</code>, <code>Total Ports (phy)</code></li>
<li><code>Access Ports</code>, <code>Trunk Ports</code>, <code>Routed Ports</code></li>
<li><code>Connected</code>, <code>Not Connected</code>, <code>Admin Down</code>, <code>Err-Disabled</code></li>
<li><code>% Access of Total</code>, <code>% Trunk of Total</code>, <code>% Routed of Total</code>, <code>% Connected of Total</code></li>
</ul>
<h3 id="2-one-sheet-per-device">2) One Sheet Per Device<a class="headerlink" href="#2-one-sheet-per-device" title="Anchor link to this section">&para;</a></h3>
<p>Columns typically include (when available):</p>
<ul>
<li><code>Device</code>, <code>Mgmt IP</code>, <code>Interface</code> (long form), <code>Description</code></li>
<li><code>Status</code> (normalised: connected / notconnect / administratively down / err-disabled)</li>
<li><code>AdminDown</code>, <code>Connected</code>, <code>ErrDisabled</code> (booleans for quick filters)</li>
<li><code>Mode</code> (access/trunk/routed), <code>VLAN</code></li>
<li><code>Duplex</code>, <code>Speed</code>, <code>Type</code></li>
<li><code>Input Errors</code>, <code>Output Errors</code>, <code>CRC Errors</code></li>
<li><code>Last Input</code> (raw text)</li>
<li><code>PoE Power (W)</code>, <code>PoE Oper</code>, <code>PoE Admin</code></li>
<li><code>LLDP/CDP Neighbour</code> (boolean)</li>
<li><code>Stale (‚â•&lt;N&gt; d)</code> (boolean)</li>
</ul>
<h3 id="formatting">Formatting<a class="headerlink" href="#formatting" title="Anchor link to this section">&para;</a></h3>
<ul>
<li><strong>Frozen header</strong> (<code>A2</code>) and AutoFilter across all columns</li>
<li><strong>Auto-sized columns</strong> with sensible min/max widths</li>
<li><strong>Conditional formatting:</strong></li>
<li><code>Status = connected</code> ‚Üí green</li>
<li><code>Status = notconnect</code> / <code>err-disabled</code> ‚Üí red</li>
<li><code>Status = administratively down</code> ‚Üí grey</li>
<li>Any <code>*Errors</code> &gt; 0 ‚Üí red</li>
<li><code>PoE Power (W)</code> &gt; 0 ‚Üí green</li>
<li><code>Stale (‚â•N d)</code> = TRUE ‚Üí red</li>
</ul>
<hr />
<h2 id="performance-concurrency">‚öôÔ∏è Performance &amp; Concurrency<a class="headerlink" href="#performance-concurrency" title="Anchor link to this section">&para;</a></h2>
<ul>
<li>Uses a <code>ThreadPoolExecutor</code> with <code>--workers</code> threads (default 10)</li>
<li>An event-driven progress bar updates as jobs start/finish</li>
<li>Each device is independent; a failure on one does not stop others</li>
</ul>
<p>The script prints an event-driven progress bar like:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-34-1">1</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1"></a>Progress: [‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë] 12/30 started: 15/30
</code></pre></div></td></tr></table></div>
<p>On completion, the Excel workbook is written to the filename you specify (default <code>audit.xlsx</code>).</p>
<hr />
<h2 id="logging-debug-and-errors">ÔøΩ Logging, Debug, and Errors<a class="headerlink" href="#logging-debug-and-errors" title="Anchor link to this section">&para;</a></h2>
<ul>
<li>Add <code>--debug</code> to surface additional prints (e.g., enable mode attempts, jump host info, file counts)</li>
<li>Per-device errors are captured into the device's summary row (and a minimal sheet may be created with the error text so the workbook always reflects all devices)</li>
</ul>
<p><strong>Common runtime issues &amp; tips:</strong></p>
<ul>
<li><strong>Authentication failures</strong> ‚Üí check Credential Manager entry or typed credentials</li>
<li><strong>SSH connectivity</strong> ‚Üí verify reachability from the workstation or via the jump host</li>
<li><strong>TextFSM templates missing</strong> ‚Üí parsing still proceeds, but some fields may be blank</li>
<li><strong>Channel/line rate limits on older devices</strong> ‚Üí consider lowering <code>--workers</code></li>
</ul>
<hr />
<h2 id="extending-and-customizing">üîß Extending and Customizing<a class="headerlink" href="#extending-and-customizing" title="Anchor link to this section">&para;</a></h2>
<ul>
<li><strong>Credentials:</strong> Adapt <code>Modules/credentials.py</code> to your environment (Linux keyring, Azure Key Vault, etc.)</li>
<li><strong>Jump host:</strong> Tune <code>Modules/jump_manager.py</code> (keep-alive, ciphers, auth methods) as needed</li>
<li><strong>Connection behaviour:</strong> Modify <code>Modules/netmiko_utils.py</code> for device types, timeouts, or SSH options</li>
<li><strong>Configuration:</strong> Edit <code>config.yaml</code> to set organizational defaults:</li>
<li><code>network.jump_host</code>: Default bastion server</li>
<li><code>concurrency.default_workers</code>: Concurrent device sessions</li>
<li><code>stale_detection.default_stale_days</code>: Stale port threshold</li>
<li><code>credentials.cred_target</code>: Credential Manager target name</li>
<li><code>output.default_filename</code>: Default Excel output filename</li>
<li><strong>Output columns:</strong> Adjust record construction in <code>main.py</code> (search for <code>detailed.append({...})</code>)</li>
<li><strong>Conditional formatting:</strong> Tweak <code>_format_worksheet()</code> in <code>main.py</code></li>
<li><strong>Parsers:</strong> Modify <code>parse_show_interfaces_status()</code> or <code>parse_show_power_inline()</code> for custom parsing logic</li>
</ul>
<p><strong>Example config.yaml for Enterprise:</strong></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-35-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-35-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-35-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-35-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-35-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-35-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-35-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-35-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-35-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-35-10">10</a></span>
<span class="normal"><a href="#__codelineno-35-11">11</a></span>
<span class="normal"><a href="#__codelineno-35-12">12</a></span>
<span class="normal"><a href="#__codelineno-35-13">13</a></span>
<span class="normal"><a href="#__codelineno-35-14">14</a></span>
<span class="normal"><a href="#__codelineno-35-15">15</a></span>
<span class="normal"><a href="#__codelineno-35-16">16</a></span>
<span class="normal"><a href="#__codelineno-35-17">17</a></span>
<span class="normal"><a href="#__codelineno-35-18">18</a></span>
<span class="normal"><a href="#__codelineno-35-19">19</a></span>
<span class="normal"><a href="#__codelineno-35-20">20</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1"></a><span class="nt">network</span><span class="p">:</span>
<a id="__codelineno-35-2" name="__codelineno-35-2"></a><span class="w">  </span><span class="nt">jump_host</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bastion.corp.example.com&quot;</span>
<a id="__codelineno-35-3" name="__codelineno-35-3"></a><span class="w">  </span><span class="nt">read_timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">45</span><span class="w">  </span><span class="c1"># Slower WAN links</span>
<a id="__codelineno-35-4" name="__codelineno-35-4"></a>
<a id="__codelineno-35-5" name="__codelineno-35-5"></a><span class="nt">credentials</span><span class="p">:</span>
<a id="__codelineno-35-6" name="__codelineno-35-6"></a><span class="w">  </span><span class="nt">cred_target</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;NetworkAudit/Production&quot;</span>
<a id="__codelineno-35-7" name="__codelineno-35-7"></a>
<a id="__codelineno-35-8" name="__codelineno-35-8"></a><span class="nt">concurrency</span><span class="p">:</span>
<a id="__codelineno-35-9" name="__codelineno-35-9"></a><span class="w">  </span><span class="nt">default_workers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w">  </span><span class="c1"># Fast discovery</span>
<a id="__codelineno-35-10" name="__codelineno-35-10"></a><span class="w">  </span><span class="nt">retry_attempts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w">    </span><span class="c1"># More retries for flaky network</span>
<a id="__codelineno-35-11" name="__codelineno-35-11"></a>
<a id="__codelineno-35-12" name="__codelineno-35-12"></a><span class="nt">stale_detection</span><span class="p">:</span>
<a id="__codelineno-35-13" name="__codelineno-35-13"></a><span class="w">  </span><span class="nt">default_stale_days</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">90</span><span class="w">  </span><span class="c1"># Longer threshold</span>
<a id="__codelineno-35-14" name="__codelineno-35-14"></a>
<a id="__codelineno-35-15" name="__codelineno-35-15"></a><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-35-16" name="__codelineno-35-16"></a><span class="w">  </span><span class="nt">default_filename</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;port_audit_report.xlsx&quot;</span>
<a id="__codelineno-35-17" name="__codelineno-35-17"></a>
<a id="__codelineno-35-18" name="__codelineno-35-18"></a><span class="nt">excel_formatting</span><span class="p">:</span>
<a id="__codelineno-35-19" name="__codelineno-35-19"></a><span class="w">  </span><span class="nt">min_column_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">12</span>
<a id="__codelineno-35-20" name="__codelineno-35-20"></a><span class="w">  </span><span class="nt">max_column_width</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">60</span>
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="security-considerations">üîí Security Considerations<a class="headerlink" href="#security-considerations" title="Anchor link to this section">&para;</a></h2>
<ul>
<li>Prefer secure stores over plaintext</li>
<li>Limit who can run the tool and who can read the generated Excel</li>
<li>When using a jump host, ensure strong authentication and proper network segmentation</li>
</ul>
<hr />
<h2 id="compatibility">üß© Compatibility<a class="headerlink" href="#compatibility" title="Anchor link to this section">&para;</a></h2>
<ul>
<li><strong>Target devices:</strong> Cisco IOS/IOS-XE access and distribution switches reachable via SSH</li>
<li>The tool relies on Netmiko; specify the right device type(s) inside <code>netmiko_utils.py</code></li>
<li>TextFSM/NTC templates significantly improve interface parsing fidelity but are not strictly required</li>
</ul>
<h3 id="tested-devices">Tested Devices<a class="headerlink" href="#tested-devices" title="Anchor link to this section">&para;</a></h3>
<p>This tool has been tested and verified on the following Cisco IOS and IOS-XE platforms:</p>
<ul>
<li><strong>Catalyst 9200 Series</strong></li>
<li><strong>Catalyst 3650 Series</strong></li>
<li><strong>Catalyst 3650C</strong></li>
<li><strong>Catalyst 3650CG</strong></li>
<li><strong>Catalyst 3650CX</strong></li>
<li><strong>Catalyst 2960X Series</strong></li>
<li><strong>Catalyst 2960 Series</strong></li>
</ul>
<blockquote>
<p><strong>Note:</strong> The tool should work with any Cisco IOS/IOS-XE device that supports the required show commands (interfaces, status, power inline, CDP/LLDP). The devices listed above have been explicitly tested and validated.</p>
</blockquote>
<hr />
<h2 id="examples">‚úÖ Examples<a class="headerlink" href="#examples" title="Anchor link to this section">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-36-1">1</a></span>
<span class="normal"><a href="#__codelineno-36-2">2</a></span>
<span class="normal"><a href="#__codelineno-36-3">3</a></span>
<span class="normal"><a href="#__codelineno-36-4">4</a></span>
<span class="normal"><a href="#__codelineno-36-5">5</a></span>
<span class="normal"><a href="#__codelineno-36-6">6</a></span>
<span class="normal"><a href="#__codelineno-36-7">7</a></span>
<span class="normal"><a href="#__codelineno-36-8">8</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1"></a><span class="c1"># Basic, with jump host</span>
<a id="__codelineno-36-2" name="__codelineno-36-2"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>-d<span class="w"> </span>devices.txt<span class="w"> </span>-o<span class="w"> </span>audit.xlsx
<a id="__codelineno-36-3" name="__codelineno-36-3"></a>
<a id="__codelineno-36-4" name="__codelineno-36-4"></a><span class="c1"># Direct (no bastion), 20 workers, stale disabled</span>
<a id="__codelineno-36-5" name="__codelineno-36-5"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>--direct<span class="w"> </span>-w<span class="w"> </span><span class="m">20</span><span class="w"> </span>--stale-days<span class="w"> </span><span class="m">0</span><span class="w"> </span>-d<span class="w"> </span>devices.txt<span class="w"> </span>-o<span class="w"> </span>audit.xlsx
<a id="__codelineno-36-6" name="__codelineno-36-6"></a>
<a id="__codelineno-36-7" name="__codelineno-36-7"></a><span class="c1"># Conservative concurrency, higher stale threshold, verbose</span>
<a id="__codelineno-36-8" name="__codelineno-36-8"></a>python<span class="w"> </span>-m<span class="w"> </span>main<span class="w"> </span>-w<span class="w"> </span><span class="m">4</span><span class="w"> </span>--stale-days<span class="w"> </span><span class="m">90</span><span class="w"> </span>--debug<span class="w"> </span>-d<span class="w"> </span>devices.txt<span class="w"> </span>-o<span class="w"> </span>siteA.xlsx
</code></pre></div></td></tr></table></div>
<hr />
<h2 id="faqs">üß† FAQs<a class="headerlink" href="#faqs" title="Anchor link to this section">&para;</a></h2>
<p><strong>Q: Do I need NTC TextFSM templates?</strong><br />
A: They are recommended for better <code>show interfaces</code> parsing. Without them, the script still works and uses its internal parser for <code>show interfaces status</code> and best-effort logic elsewhere.</p>
<p><strong>Q: Where do credentials come from?</strong><br />
A: On Windows, from Credential Manager (default target <code>MyApp/ADM</code>). Otherwise, you are prompted interactively or you can adapt <code>credentials.py</code> to your secret store.</p>
<p><strong>Q: How is <code>Mode</code> determined?</strong><br />
A: From <code>show interfaces status</code>: if VLAN column is <code>trunk</code>/<code>rspan</code> ‚Üí <code>trunk</code>; if <code>routed</code> ‚Üí <code>routed</code>; otherwise <code>access</code>.</p>
<p><strong>Q: How is a port considered stale?</strong><br />
A: Only for access ports and when <code>--stale-days &gt; 0</code>. Connected ports are flagged stale only if <code>Last input ‚â• N days</code>. Disconnected ports require both no PoE draw and no LLDP/CDP neighbour to be flagged stale.</p>
<hr />
<hr />
<h2 id="learning-outcomes">üéì Learning Outcomes<a class="headerlink" href="#learning-outcomes" title="Anchor link to this section">&para;</a></h2>
<p>After studying this code, you should understand:</p>
<p>‚úÖ <strong>YAML Configuration Management</strong> ‚Äî How to separate configuration from code using YAML with Python<br />
‚úÖ <strong>Fixed-Width Parsing</strong> ‚Äî Reliable CLI output parsing without external dependencies<br />
‚úÖ <strong>Multi-Source Data Fusion</strong> ‚Äî Correlating data across different commands using interface name aliasing<br />
‚úÖ <strong>Conservative Risk Assessment</strong> ‚Äî Stale port detection logic that minimizes false positives<br />
‚úÖ <strong>Thread-Safe Concurrency</strong> ‚Äî Parallel device audits with proper lock management<br />
‚úÖ <strong>Intelligent Fallback Strategy</strong> ‚Äî TextFSM + custom parsers for maximum compatibility<br />
‚úÖ <strong>SSH Tunneling</strong> ‚Äî Jump host integration with Paramiko direct-tcpip channels<br />
‚úÖ <strong>Excel Automation</strong> ‚Äî Professional workbook generation with conditional formatting<br />
‚úÖ <strong>Exponential Backoff</strong> ‚Äî Retry logic for transient network failures<br />
‚úÖ <strong>Credential Management</strong> ‚Äî Secure OS-level credential storage integration  </p>
<h3 id="key-code-patterns-demonstrated">Key Code Patterns Demonstrated<a class="headerlink" href="#key-code-patterns-demonstrated" title="Anchor link to this section">&para;</a></h3>
<p><strong>Pattern 1: Graceful Degradation</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-37-1">1</a></span>
<span class="normal"><a href="#__codelineno-37-2">2</a></span>
<span class="normal"><a href="#__codelineno-37-3">3</a></span>
<span class="normal"><a href="#__codelineno-37-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-37-2" name="__codelineno-37-2"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">parse_with_textfsm</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>  <span class="c1"># Preferred method</span>
<a id="__codelineno-37-3" name="__codelineno-37-3"></a><span class="k">except</span><span class="p">:</span>
<a id="__codelineno-37-4" name="__codelineno-37-4"></a>    <span class="n">data</span> <span class="o">=</span> <span class="n">parse_with_custom_logic</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>  <span class="c1"># Fallback</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern 2: Multi-Key Lookup</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-38-1">1</a></span>
<span class="normal"><a href="#__codelineno-38-2">2</a></span>
<span class="normal"><a href="#__codelineno-38-3">3</a></span>
<span class="normal"><a href="#__codelineno-38-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-38-1" name="__codelineno-38-1"></a><span class="k">for</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">all_aliases</span><span class="p">(</span><span class="n">interface_name</span><span class="p">):</span>
<a id="__codelineno-38-2" name="__codelineno-38-2"></a>    <span class="k">if</span> <span class="n">alias</span> <span class="ow">in</span> <span class="n">poe_map</span><span class="p">:</span>
<a id="__codelineno-38-3" name="__codelineno-38-3"></a>        <span class="n">poe_data</span> <span class="o">=</span> <span class="n">poe_map</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span>
<a id="__codelineno-38-4" name="__codelineno-38-4"></a>        <span class="k">break</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern 3: Thread-Safe Accumulation</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-39-1">1</a></span>
<span class="normal"><a href="#__codelineno-39-2">2</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-39-1" name="__codelineno-39-1"></a><span class="k">with</span> <span class="n">lock</span><span class="p">:</span>
<a id="__codelineno-39-2" name="__codelineno-39-2"></a>    <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_data</span><span class="p">)</span>  <span class="c1"># Atomic operation</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern 4: Conservative Classification</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-40-1">1</a></span>
<span class="normal"><a href="#__codelineno-40-2">2</a></span>
<span class="normal"><a href="#__codelineno-40-3">3</a></span>
<span class="normal"><a href="#__codelineno-40-4">4</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-40-1" name="__codelineno-40-1"></a><span class="k">if</span> <span class="n">condition_A</span> <span class="ow">and</span> <span class="n">condition_B</span><span class="p">:</span>  <span class="c1"># Both must be true</span>
<a id="__codelineno-40-2" name="__codelineno-40-2"></a>    <span class="n">mark_as_risky</span><span class="p">()</span>
<a id="__codelineno-40-3" name="__codelineno-40-3"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-40-4" name="__codelineno-40-4"></a>    <span class="n">mark_as_safe</span><span class="p">()</span>  <span class="c1"># Default to safe</span>
</code></pre></div></td></tr></table></div></p>
<p><strong>Pattern 5: Type-Safe Configuration</strong>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-41-1">1</a></span>
<span class="normal"><a href="#__codelineno-41-2">2</a></span>
<span class="normal"><a href="#__codelineno-41-3">3</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-41-1" name="__codelineno-41-1"></a><span class="nd">@property</span>
<a id="__codelineno-41-2" name="__codelineno-41-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">default_workers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<a id="__codelineno-41-3" name="__codelineno-41-3"></a>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_nested</span><span class="p">(</span><span class="s2">&quot;concurrency&quot;</span><span class="p">,</span> <span class="s2">&quot;default_workers&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<hr />
<h2 id="distribution-execution">üöÄ Distribution &amp; Execution<a class="headerlink" href="#distribution-execution" title="Anchor link to this section">&para;</a></h2>
<p>Consistent with the <strong>Nautomation Prime</strong> delivery model, this tool is available in multiple formats:</p>
<ul>
<li>
<p><strong>Zero-Install Portable Bundle:</strong> A self-contained package including the Python interpreter and all libraries (Netmiko, Pandas, OpenPyXL) for use on restricted Windows jump boxes.</p>
</li>
<li>
<p><strong>Scheduled Docker Appliance:</strong> A pre-built container designed for autonomous execution and periodic port auditing.</p>
</li>
<li>
<p><strong>Source Code:</strong> Full access to customize parsing logic, add vendor-specific commands, or integrate with your CMDB.</p>
</li>
</ul>
<hr />
<h2 id="licence">üìã Licence<a class="headerlink" href="#licence" title="Anchor link to this section">&para;</a></h2>
<p>GNU General Public Licence v3.0</p>
<h2 id="author">üë§ Author<a class="headerlink" href="#author" title="Anchor link to this section">&para;</a></h2>
<p>Christopher Davies</p>
<hr />
<blockquote>
<p><strong>Mission:</strong> To empower network engineers with transparent, hardened Python tools that eliminate manual audits and expose infrastructure health at a glance.</p>
</blockquote>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="February 5, 2026 17:52:02 UTC">February 5, 2026</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      ¬© 2026 Christopher Davies T/A Nautomation Prime ‚Äî Not affiliated with Cisco Systems, Inc.<br> Empowering Network Automation Professionals ¬∑ Built with Material for MkDocs

    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://www.linkedin.com/company/nautomationprime" target="_blank" rel="noopener" title="LinkedIn" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
    <a href="https://github.com/Nautomation-Prime" target="_blank" rel="noopener" title="GitHub" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
    <a href="mailto:nautomationprime.f3wfe@simplelogin.com" target="_blank" rel="noopener" title="Contact Nautomation Prime" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.tracking", "navigation.indexes", "toc.integrate", "content.code.copy", "content.code.annotate", "content.tooltips", "search.share", "search.suggest", "search.highlight", "search.stemmer", "announce.dismiss"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>